<h1 id="fibrations-in-agda">Fibrations in agda</h1>
<p>I have recently decided to iron all the kinks of a few proofs left as exercises in Bart Jacobs’ book <em>Categorical logic and type theory</em>, by proving them in agda (and in particular, using <a href="https://github.com/agda/agda-categories">agda-categories</a>).</p>
The first obligatory step is some boilerplate code: let’s keep this to a minimum.
<pre class="Agda"><a id="370" class="Keyword">module</a> <a id="377" href="simple.html" class="Module">simple</a> <a id="384" class="Symbol">{</a><a id="385" href="simple.html#385" class="Bound">I</a> <a id="387" class="Symbol">:</a> <a id="389" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="392" class="Symbol">}</a> <a id="394" class="Keyword">where</a>

<a id="401" class="Keyword">open</a> <a id="406" class="Keyword">import</a> <a id="413" href="Categories.Category.html" class="Module">Categories.Category</a>
<a id="433" class="Keyword">open</a> <a id="438" class="Keyword">import</a> <a id="445" href="Categories.Category.Cartesian.Bundle.html" class="Module">Categories.Category.Cartesian.Bundle</a>
<a id="482" class="Keyword">open</a> <a id="487" class="Keyword">import</a> <a id="494" href="Categories.Category.CartesianClosed.Canonical.html" class="Module">Categories.Category.CartesianClosed.Canonical</a>
<a id="540" class="Keyword">open</a> <a id="545" class="Keyword">import</a> <a id="552" href="Categories.Category.Core.html" class="Module">Categories.Category.Core</a>
<a id="577" class="Keyword">open</a> <a id="582" class="Keyword">import</a> <a id="589" href="Data.Product.html" class="Module">Data.Product</a>
<a id="602" class="Keyword">open</a> <a id="607" class="Keyword">import</a> <a id="614" href="Function.html" class="Module">Function</a> <a id="623" class="Keyword">using</a> <a id="629" class="Symbol">(</a><a id="630" href="Function.Base.html#716" class="Function">const</a><a id="635" class="Symbol">)</a>
<a id="637" class="Keyword">open</a> <a id="642" class="Keyword">import</a> <a id="649" href="Level.html" class="Module">Level</a>
<a id="655" class="Keyword">open</a> <a id="660" class="Keyword">import</a> <a id="667" href="Relation.Binary.Core.html" class="Module">Relation.Binary.Core</a> <a id="688" class="Keyword">using</a> <a id="694" class="Symbol">(</a><a id="695" href="Relation.Binary.Core.html#882" class="Function">Rel</a><a id="698" class="Symbol">)</a>
<a id="700" class="Keyword">open</a> <a id="705" class="Keyword">import</a> <a id="712" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
<a id="750" class="Keyword">open</a> <a id="755" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">Relation.Binary.PropositionalEquality.≡-Reasoning</a>
<a id="805" class="Keyword">open</a> <a id="810" class="Keyword">import</a> <a id="817" href="Categories.Functor.html" class="Module">Categories.Functor</a>
<a id="836" class="Keyword">open</a> <a id="841" class="Keyword">import</a> <a id="848" href="Categories.Functor.Bifunctor.html" class="Module">Categories.Functor.Bifunctor</a>
<a id="877" class="Keyword">open</a> <a id="882" class="Keyword">import</a> <a id="889" href="Categories.Comonad.html" class="Module">Categories.Comonad</a>
<a id="908" class="Keyword">open</a> <a id="913" class="Keyword">import</a> <a id="920" href="Categories.Category.Construction.CoEilenbergMoore.html" class="Module">Categories.Category.Construction.CoEilenbergMoore</a>
<a id="970" class="Keyword">open</a> <a id="975" class="Keyword">import</a> <a id="982" href="Categories.NaturalTransformation.html" class="Module">Categories.NaturalTransformation</a> <a id="1015" class="Symbol">as</a> <a id="1018" class="Module">NT</a> <a id="1021" class="Keyword">using</a> <a id="1027" class="Symbol">(</a><a id="1028" href="Categories.NaturalTransformation.Core.html#1750" class="Function">ntHelper</a><a id="1036" class="Symbol">)</a>
<a id="1038" class="Keyword">open</a> <a id="1043" class="Keyword">import</a> <a id="1050" href="Categories.NaturalTransformation.NaturalIsomorphism.html" class="Module">Categories.NaturalTransformation.NaturalIsomorphism</a> <a id="1102" class="Keyword">hiding</a> <a id="1109" class="Symbol">(</a><a id="1110" href="Categories.NaturalTransformation.NaturalIsomorphism.html#4148" class="Function">refl</a><a id="1114" class="Symbol">;</a> <a id="1116" href="Categories.NaturalTransformation.NaturalIsomorphism.html#4358" class="Function">sym</a><a id="1119" class="Symbol">;</a> <a id="1121" href="Categories.NaturalTransformation.NaturalIsomorphism.html#4598" class="Function">trans</a><a id="1126" class="Symbol">)</a>
<a id="1128" class="Keyword">import</a> <a id="1135" href="Categories.Category.Equivalence.html" class="Module">Categories.Category.Equivalence</a> <a id="1167" class="Symbol">as</a> <a id="1170" class="Module">E</a>

<a id="1173" class="Keyword">private</a>
  <a id="1183" class="Keyword">variable</a>
    <a id="1196" href="simple.html#1196" class="Generalizable">a</a> <a id="1198" href="simple.html#1198" class="Generalizable">b</a> <a id="1200" href="simple.html#1200" class="Generalizable">c</a> <a id="1202" class="Symbol">:</a> <a id="1204" href="Agda.Primitive.html#597" class="Postulate">Level</a>

<a id="1211" class="Comment">-- I have to redefine function composition. A rename or this will do:</a>
<a id="_⋆_"></a><a id="1281" href="simple.html#1281" class="Function Operator">_⋆_</a> <a id="1285" class="Symbol">:</a> <a id="1287" class="Symbol">∀</a> <a id="1289" class="Symbol">{</a><a id="1290" href="simple.html#1290" class="Bound">A</a> <a id="1292" class="Symbol">:</a> <a id="1294" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1298" href="simple.html#1196" class="Generalizable">a</a><a id="1299" class="Symbol">}</a> <a id="1301" class="Symbol">{</a><a id="1302" href="simple.html#1302" class="Bound">B</a> <a id="1304" class="Symbol">:</a> <a id="1306" href="simple.html#1290" class="Bound">A</a> <a id="1308" class="Symbol">→</a> <a id="1310" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1314" href="simple.html#1198" class="Generalizable">b</a><a id="1315" class="Symbol">}</a> <a id="1317" class="Symbol">{</a><a id="1318" href="simple.html#1318" class="Bound">C</a> <a id="1320" class="Symbol">:</a> <a id="1322" class="Symbol">{</a><a id="1323" href="simple.html#1323" class="Bound">x</a> <a id="1325" class="Symbol">:</a> <a id="1327" href="simple.html#1290" class="Bound">A</a><a id="1328" class="Symbol">}</a> <a id="1330" class="Symbol">→</a> <a id="1332" href="simple.html#1302" class="Bound">B</a> <a id="1334" href="simple.html#1323" class="Bound">x</a> <a id="1336" class="Symbol">→</a> <a id="1338" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1342" href="simple.html#1200" class="Generalizable">c</a><a id="1343" class="Symbol">}</a> <a id="1345" class="Symbol">→</a>
      <a id="1353" class="Symbol">(∀</a> <a id="1356" class="Symbol">{</a><a id="1357" href="simple.html#1357" class="Bound">x</a><a id="1358" class="Symbol">}</a> <a id="1360" class="Symbol">(</a><a id="1361" href="simple.html#1361" class="Bound">y</a> <a id="1363" class="Symbol">:</a> <a id="1365" href="simple.html#1302" class="Bound">B</a> <a id="1367" href="simple.html#1357" class="Bound">x</a><a id="1368" class="Symbol">)</a> <a id="1370" class="Symbol">→</a> <a id="1372" href="simple.html#1318" class="Bound">C</a> <a id="1374" href="simple.html#1361" class="Bound">y</a><a id="1375" class="Symbol">)</a> <a id="1377" class="Symbol">→</a> <a id="1379" class="Symbol">(</a><a id="1380" href="simple.html#1380" class="Bound">g</a> <a id="1382" class="Symbol">:</a> <a id="1384" class="Symbol">(</a><a id="1385" href="simple.html#1385" class="Bound">x</a> <a id="1387" class="Symbol">:</a> <a id="1389" href="simple.html#1290" class="Bound">A</a><a id="1390" class="Symbol">)</a> <a id="1392" class="Symbol">→</a> <a id="1394" href="simple.html#1302" class="Bound">B</a> <a id="1396" href="simple.html#1385" class="Bound">x</a><a id="1397" class="Symbol">)</a> <a id="1399" class="Symbol">→</a>
      <a id="1407" class="Symbol">((</a><a id="1409" href="simple.html#1409" class="Bound">x</a> <a id="1411" class="Symbol">:</a> <a id="1413" href="simple.html#1290" class="Bound">A</a><a id="1414" class="Symbol">)</a> <a id="1416" class="Symbol">→</a> <a id="1418" href="simple.html#1318" class="Bound">C</a> <a id="1420" class="Symbol">(</a><a id="1421" href="simple.html#1380" class="Bound">g</a> <a id="1423" href="simple.html#1409" class="Bound">x</a><a id="1424" class="Symbol">))</a>
<a id="1427" href="simple.html#1427" class="Bound">f</a> <a id="1429" href="simple.html#1281" class="Function Operator">⋆</a> <a id="1431" href="simple.html#1431" class="Bound">g</a> <a id="1433" class="Symbol">=</a> <a id="1435" class="Symbol">λ</a> <a id="1437" href="simple.html#1437" class="Bound">x</a> <a id="1439" class="Symbol">→</a> <a id="1441" href="simple.html#1427" class="Bound">f</a> <a id="1443" class="Symbol">(</a><a id="1444" href="simple.html#1431" class="Bound">g</a> <a id="1446" href="simple.html#1437" class="Bound">x</a><a id="1447" class="Symbol">)</a>
</pre>
and next, the terminal type, and a lemma that says it has only one term (some proofs of uniqueness require extensionality plus this lemma):
<pre class="Agda"><a id="1597" class="Keyword">data</a> <a id="t"></a><a id="1602" href="simple.html#1602" class="Datatype">t</a> <a id="1604" class="Symbol">:</a> <a id="1606" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1610" class="Keyword">where</a>
 <a id="t.⊤"></a><a id="1617" href="simple.html#1617" class="InductiveConstructor">⊤</a> <a id="1619" class="Symbol">:</a> <a id="1621" href="simple.html#1602" class="Datatype">t</a>

<a id="!-unique-lemma"></a><a id="1624" href="simple.html#1624" class="Function">!-unique-lemma</a> <a id="1639" class="Symbol">:</a> <a id="1641" class="Symbol">∀</a> <a id="1643" class="Symbol">(</a><a id="1644" href="simple.html#1644" class="Bound">x</a> <a id="1646" class="Symbol">:</a> <a id="1648" href="simple.html#1602" class="Datatype">t</a><a id="1649" class="Symbol">)</a> <a id="1651" class="Symbol">→</a> <a id="1653" href="simple.html#1617" class="InductiveConstructor">⊤</a> <a id="1655" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1657" href="simple.html#1644" class="Bound">x</a>
<a id="1659" href="simple.html#1624" class="Function">!-unique-lemma</a> <a id="1674" href="simple.html#1617" class="InductiveConstructor">⊤</a> <a id="1676" class="Symbol">=</a> <a id="1678" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="1684" class="Keyword">postulate</a>
 <a id="1695" class="Comment">-- we need to postulate extensionality...</a>
 <a id="extensionality"></a><a id="1738" href="simple.html#1738" class="Postulate">extensionality</a> <a id="1753" class="Symbol">:</a> <a id="1755" class="Symbol">∀</a> <a id="1757" class="Symbol">{</a><a id="1758" href="simple.html#1758" class="Bound">A</a> <a id="1760" href="simple.html#1760" class="Bound">B</a> <a id="1762" class="Symbol">:</a> <a id="1764" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1767" class="Symbol">}</a> <a id="1769" class="Symbol">{</a><a id="1770" href="simple.html#1770" class="Bound">f</a> <a id="1772" href="simple.html#1772" class="Bound">g</a> <a id="1774" class="Symbol">:</a> <a id="1776" href="simple.html#1758" class="Bound">A</a> <a id="1778" class="Symbol">→</a> <a id="1780" href="simple.html#1760" class="Bound">B</a><a id="1781" class="Symbol">}</a> <a id="1783" class="Symbol">→</a>
  <a id="1787" class="Symbol">(∀</a> <a id="1790" class="Symbol">(</a><a id="1791" href="simple.html#1791" class="Bound">x</a> <a id="1793" class="Symbol">:</a> <a id="1795" href="simple.html#1758" class="Bound">A</a><a id="1796" class="Symbol">)</a> <a id="1798" class="Symbol">→</a> <a id="1800" href="simple.html#1770" class="Bound">f</a> <a id="1802" href="simple.html#1791" class="Bound">x</a> <a id="1804" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1806" href="simple.html#1772" class="Bound">g</a> <a id="1808" href="simple.html#1791" class="Bound">x</a><a id="1809" class="Symbol">)</a> <a id="1811" class="Symbol">→</a> <a id="1813" href="simple.html#1770" class="Bound">f</a> <a id="1815" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1817" href="simple.html#1772" class="Bound">g</a>

<a id="1820" class="Comment">-- and a proof that the category of Sets is indeed a category.</a>
<a id="SetC"></a><a id="1883" href="simple.html#1883" class="Function">SetC</a> <a id="1888" class="Symbol">:</a> <a id="1890" href="Categories.Category.Core.html#442" class="Record">Category</a> <a id="1899" class="Symbol">(</a><a id="1900" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="1904" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="1908" class="Symbol">)</a> <a id="1910" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="1915" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="1920" class="Comment">-- a category depends on three levels:</a>
<a id="1959" class="Comment">-- 1. where the objects live,</a>
<a id="1989" class="Comment">-- 2. where the hom-set(oid)s live,</a>
<a id="2025" class="Comment">-- 3. and where the category lives.</a>
<a id="2061" href="simple.html#1883" class="Function">SetC</a> <a id="2066" class="Symbol">=</a>
 <a id="2069" class="Keyword">record</a>
  <a id="2078" class="Symbol">{</a> <a id="2080" href="Categories.Category.Core.html#559" class="Field">Obj</a> <a id="2084" class="Symbol">=</a> <a id="2086" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2092" class="Comment">-- the class of objects</a>
  <a id="2118" class="Symbol">;</a> <a id="2120" href="Categories.Category.Core.html#575" class="Field Operator">_⇒_</a> <a id="2124" class="Symbol">=</a> <a id="2126" class="Symbol">λ</a> <a id="2128" href="simple.html#2128" class="Bound">x</a> <a id="2130" href="simple.html#2130" class="Bound">y</a> <a id="2132" class="Symbol">→</a> <a id="2134" href="simple.html#2128" class="Bound">x</a> <a id="2136" class="Symbol">→</a> <a id="2138" href="simple.html#2130" class="Bound">y</a>
  <a id="2142" class="Comment">-- the relation defining the hom-setoids.</a>
  <a id="2186" class="Symbol">;</a> <a id="2188" href="Categories.Category.Core.html#595" class="Field Operator">_≈_</a> <a id="2192" class="Symbol">=</a> <a id="2194" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>
  <a id="2200" class="Comment">-- def of equality in the homs</a>
  <a id="2233" class="Symbol">;</a> <a id="2235" href="Categories.Category.Core.html#630" class="Field">id</a> <a id="2238" class="Symbol">=</a> <a id="2240" class="Symbol">λ</a> <a id="2242" href="simple.html#2242" class="Bound">x</a> <a id="2244" class="Symbol">→</a> <a id="2246" href="simple.html#2242" class="Bound">x</a>
  <a id="2250" class="Comment">-- the identity function</a>
  <a id="2277" class="Symbol">;</a> <a id="2279" href="Categories.Category.Core.html#656" class="Field Operator">_∘_</a> <a id="2283" class="Symbol">=</a> <a id="2285" class="Symbol">λ</a> <a id="2287" href="simple.html#2287" class="Bound">f</a> <a id="2289" href="simple.html#2289" class="Bound">g</a> <a id="2291" href="simple.html#2291" class="Bound">a</a> <a id="2293" class="Symbol">→</a> <a id="2295" href="simple.html#2287" class="Bound">f</a> <a id="2297" class="Symbol">(</a><a id="2298" href="simple.html#2289" class="Bound">g</a> <a id="2300" href="simple.html#2291" class="Bound">a</a><a id="2301" class="Symbol">)</a>
  <a id="2305" class="Comment">-- category composition</a>
  <a id="2331" class="Symbol">;</a> <a id="2333" href="Categories.Category.Core.html#715" class="Field">assoc</a> <a id="2339" class="Symbol">=</a> <a id="2341" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2348" class="Symbol">;</a> <a id="2350" href="Categories.Category.Core.html#1004" class="Field">sym-assoc</a> <a id="2360" class="Symbol">=</a> <a id="2362" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2369" class="Comment">-- two proofs of associativity: this makes (C^op)^op</a>
  <a id="2424" class="Comment">-- syntactically equal to C, which is nice</a>
  <a id="2469" class="Symbol">;</a> <a id="2471" href="Categories.Category.Core.html#1096" class="Field">identityˡ</a> <a id="2481" class="Symbol">=</a> <a id="2483" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2490" class="Symbol">;</a> <a id="2492" href="Categories.Category.Core.html#1145" class="Field">identityʳ</a> <a id="2502" class="Symbol">=</a> <a id="2504" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2511" class="Symbol">;</a> <a id="2513" href="Categories.Category.Core.html#1339" class="Field">identity²</a> <a id="2523" class="Symbol">=</a> <a id="2525" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2532" class="Comment">-- proofs that id . f = f = f . id and id . id = id</a>
  <a id="2586" class="Symbol">;</a> <a id="2588" href="Categories.Category.Core.html#1384" class="Field">equiv</a> <a id="2594" class="Symbol">=</a> <a id="2596" class="Keyword">record</a> <a id="2603" class="Symbol">{</a> <a id="2605" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="2610" class="Symbol">=</a> <a id="2612" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2617" class="Symbol">;</a> <a id="2619" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="2623" class="Symbol">=</a> <a id="2625" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="2629" class="Symbol">;</a> <a id="2631" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="2637" class="Symbol">=</a> <a id="2639" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="2645" class="Symbol">}</a>
  <a id="2649" class="Comment">-- proof that _≈_ is an equivalence relation...</a>
  <a id="2699" class="Symbol">;</a> <a id="2701" href="Categories.Category.Core.html#1438" class="Field">∘-resp-≈</a> <a id="2710" class="Symbol">=</a> <a id="2712" class="Symbol">λ</a> <a id="2714" class="Symbol">{</a><a id="2715" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2720" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2725" class="Symbol">→</a> <a id="2727" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2731" class="Symbol">}</a>
  <a id="2735" class="Comment">-- and a congruence with respect to composition.</a>
  <a id="2786" class="Symbol">}</a>
</pre>
<p>Everything is quite trivial here; the comments I added clarify how the various records have to be filled. Probably one of the most useful tricks to learn here, is the way in which the last field was filled: I didn’t know about the existence of this when I first opened this file, and it really saved me hours.</p>
<p>Now, one of the first interesting examples in Jacobs’ book is that of a <em>simple fibration</em> over a category 𝔹 with finite products (let’s say, all finite limits, and for fibration-theory purposes, even a <em>canonical</em> choice thereof).</p>
<p>Given such a category 𝔹, the category s(𝔹) is defined having</p>
<ol type="1">
<li>objects the pairs <code>(I , X)</code> of objects in 𝔹;</li>
<li>morphisms <code>(I , X) → (J , Y)</code> are pairs of morphisms <code>u : I → J</code> and <code>f : I × X → Y</code>.</li>
</ol>
<p>The identity is the “trivial” pair made by the couple <code>(id {I} , proj₂)</code> (the projection on the second factor). The composition of <code>(u , f)</code> and <code>(v , g)</code> is defined as <code>(v ∘ u , g ∘ ⟨ u ∘ proj₁ , f ⟩)</code>, and all the other choices are either forced by this, or straightforward (for example, <code>_≈_</code> is just <code>_≡_</code>).</p>
Fortunately, agda needs just a little bit of help to figure everything out.
<pre class="Agda"><a id="simple"></a><a id="3929" href="simple.html#3929" class="Function">simple</a> <a id="3936" class="Symbol">:</a> <a id="3938" href="Categories.Category.Core.html#442" class="Record">Category</a> <a id="3947" class="Symbol">(</a><a id="3948" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="3952" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="3956" class="Symbol">)</a> <a id="3958" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="3963" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="3968" href="simple.html#3929" class="Function">simple</a> <a id="3975" class="Symbol">=</a>
 <a id="3978" class="Keyword">record</a>
  <a id="3987" class="Comment">-- structure</a>
  <a id="4002" class="Symbol">{</a> <a id="4004" href="Categories.Category.Core.html#559" class="Field">Obj</a> <a id="4008" class="Symbol">=</a> <a id="4010" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4014" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4016" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="4022" class="Symbol">;</a> <a id="4024" href="Categories.Category.Core.html#575" class="Field Operator">_⇒_</a> <a id="4028" class="Symbol">=</a> <a id="4030" href="simple.html#4351" class="Function Operator">_⇒_</a>
  <a id="4036" class="Symbol">;</a> <a id="4038" href="Categories.Category.Core.html#595" class="Field Operator">_≈_</a> <a id="4042" class="Symbol">=</a> <a id="4044" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>
  <a id="4050" class="Symbol">;</a> <a id="4052" href="Categories.Category.Core.html#630" class="Field">id</a> <a id="4055" class="Symbol">=</a> <a id="4057" class="Symbol">(λ</a> <a id="4060" href="simple.html#4060" class="Bound">z</a> <a id="4062" class="Symbol">→</a> <a id="4064" href="simple.html#4060" class="Bound">z</a><a id="4065" class="Symbol">)</a> <a id="4067" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4069" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
  <a id="4077" class="Symbol">;</a> <a id="4079" href="Categories.Category.Core.html#656" class="Field Operator">_∘_</a> <a id="4083" class="Symbol">=</a> <a id="4085" href="simple.html#4424" class="Function Operator">_∘_</a>
  <a id="4091" class="Comment">-- properties</a>
  <a id="4107" class="Symbol">;</a> <a id="4109" href="Categories.Category.Core.html#715" class="Field">assoc</a> <a id="4115" class="Symbol">=</a> <a id="4117" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4124" class="Symbol">;</a> <a id="4126" href="Categories.Category.Core.html#1004" class="Field">sym-assoc</a> <a id="4136" class="Symbol">=</a> <a id="4138" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4145" class="Symbol">;</a> <a id="4147" href="Categories.Category.Core.html#1096" class="Field">identityˡ</a> <a id="4157" class="Symbol">=</a> <a id="4159" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4166" class="Symbol">;</a> <a id="4168" href="Categories.Category.Core.html#1145" class="Field">identityʳ</a> <a id="4178" class="Symbol">=</a> <a id="4180" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4187" class="Symbol">;</a> <a id="4189" href="Categories.Category.Core.html#1339" class="Field">identity²</a> <a id="4199" class="Symbol">=</a> <a id="4201" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="4208" class="Comment">-- whew, they&#39;re all trivial!</a>
  <a id="4240" class="Symbol">;</a> <a id="4242" href="Categories.Category.Core.html#1384" class="Field">equiv</a> <a id="4248" class="Symbol">=</a> <a id="4250" class="Keyword">record</a> <a id="4257" class="Symbol">{</a> <a id="4259" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="4264" class="Symbol">=</a> <a id="4266" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4271" class="Symbol">;</a> <a id="4273" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="4277" class="Symbol">=</a> <a id="4279" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="4283" class="Symbol">;</a> <a id="4285" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="4291" class="Symbol">=</a> <a id="4293" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="4299" class="Symbol">}</a>
  <a id="4303" class="Symbol">;</a> <a id="4305" href="Categories.Category.Core.html#1438" class="Field">∘-resp-≈</a> <a id="4314" class="Symbol">=</a> <a id="4316" class="Symbol">λ</a> <a id="4318" class="Symbol">{</a><a id="4319" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4324" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4329" class="Symbol">→</a> <a id="4331" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="4335" class="Symbol">}</a>
  <a id="4339" class="Symbol">}</a>
  <a id="4343" class="Keyword">where</a>
  <a id="4351" href="simple.html#4351" class="Function Operator">_⇒_</a> <a id="4355" class="Symbol">:</a> <a id="4357" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="4361" class="Symbol">(</a><a id="4362" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4366" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4368" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4371" class="Symbol">)</a> <a id="4373" href="Agda.Primitive.html#764" class="Primitive">zero</a>
  <a id="4380" class="Symbol">(</a><a id="4381" href="simple.html#4381" class="Bound">i</a> <a id="4383" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4385" href="simple.html#4385" class="Bound">x</a><a id="4386" class="Symbol">)</a> <a id="4388" href="simple.html#4351" class="Function Operator">⇒</a> <a id="4390" class="Symbol">(</a><a id="4391" href="simple.html#4391" class="Bound">j</a> <a id="4393" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4395" href="simple.html#4395" class="Bound">y</a><a id="4396" class="Symbol">)</a> <a id="4398" class="Symbol">=</a> <a id="4400" class="Symbol">(</a><a id="4401" href="simple.html#4381" class="Bound">i</a> <a id="4403" class="Symbol">→</a> <a id="4405" href="simple.html#4391" class="Bound">j</a><a id="4406" class="Symbol">)</a> <a id="4408" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4410" class="Symbol">(</a><a id="4411" href="simple.html#4385" class="Bound">x</a> <a id="4413" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4415" href="simple.html#4381" class="Bound">i</a> <a id="4417" class="Symbol">→</a> <a id="4419" href="simple.html#4395" class="Bound">y</a><a id="4420" class="Symbol">)</a>
  <a id="4424" href="simple.html#4424" class="Function Operator">_∘_</a> <a id="4428" class="Symbol">:</a> <a id="4430" class="Symbol">{</a><a id="4431" href="simple.html#4431" class="Bound">A</a> <a id="4433" href="simple.html#4433" class="Bound">B</a> <a id="4435" href="simple.html#4435" class="Bound">C</a> <a id="4437" class="Symbol">:</a> <a id="4439" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4443" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4445" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4448" class="Symbol">}</a> <a id="4450" class="Symbol">→</a> <a id="4452" href="simple.html#4433" class="Bound">B</a> <a id="4454" href="simple.html#4351" class="Function Operator">⇒</a> <a id="4456" href="simple.html#4435" class="Bound">C</a> <a id="4458" class="Symbol">→</a> <a id="4460" href="simple.html#4431" class="Bound">A</a> <a id="4462" href="simple.html#4351" class="Function Operator">⇒</a> <a id="4464" href="simple.html#4433" class="Bound">B</a> <a id="4466" class="Symbol">→</a> <a id="4468" href="simple.html#4431" class="Bound">A</a> <a id="4470" href="simple.html#4351" class="Function Operator">⇒</a> <a id="4472" href="simple.html#4435" class="Bound">C</a>
  <a id="4476" href="simple.html#4424" class="Function Operator">_∘_</a> <a id="4480" class="Symbol">{</a><a id="4481" href="simple.html#4481" class="Bound">i</a> <a id="4483" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4485" href="simple.html#4485" class="Bound">x</a><a id="4486" class="Symbol">}</a> <a id="4488" class="Symbol">{</a><a id="4489" href="simple.html#4489" class="Bound">j</a> <a id="4491" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4493" href="simple.html#4493" class="Bound">y</a><a id="4494" class="Symbol">}</a> <a id="4496" class="Symbol">{_}</a> <a id="4500" class="Symbol">(</a><a id="4501" href="simple.html#4501" class="Bound">u</a> <a id="4503" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4505" href="simple.html#4505" class="Bound">f</a><a id="4506" class="Symbol">)</a> <a id="4508" class="Symbol">(</a><a id="4509" href="simple.html#4509" class="Bound">v</a> <a id="4511" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4513" href="simple.html#4513" class="Bound">g</a><a id="4514" class="Symbol">)</a> <a id="4516" class="Symbol">=</a>
   <a id="4521" class="Symbol">(λ</a> <a id="4524" href="simple.html#4524" class="Bound">t</a> <a id="4526" class="Symbol">→</a> <a id="4528" href="simple.html#4501" class="Bound">u</a> <a id="4530" class="Symbol">(</a><a id="4531" href="simple.html#4509" class="Bound">v</a> <a id="4533" href="simple.html#4524" class="Bound">t</a><a id="4534" class="Symbol">))</a> <a id="4537" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4539" class="Symbol">λ</a> <a id="4541" href="simple.html#4541" class="Bound">t</a> <a id="4543" class="Symbol">→</a> <a id="4545" href="simple.html#4505" class="Bound">f</a> <a id="4547" class="Symbol">(</a><a id="4548" href="simple.html#4513" class="Bound">g</a> <a id="4550" href="simple.html#4541" class="Bound">t</a> <a id="4552" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4554" href="simple.html#4509" class="Bound">v</a> <a id="4556" class="Symbol">(</a><a id="4557" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="4563" href="simple.html#4541" class="Bound">t</a><a id="4564" class="Symbol">))</a>
</pre>
Now, <code>s(𝔹)</code> comes equipped with an obvious forgetful functor to 𝔹, projecting on the first component: the object of interest for Jacobs’ is the fiber of this functor over a certain <code>I ∈ 𝔹</code>. Such a category can be characterised in many ways; the most elegant is: it is a certain Kleisli category.
<pre class="Agda"><a id="fiber-of-simple"></a><a id="4871" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="4887" class="Symbol">:</a> <a id="4889" class="Symbol">{</a><a id="4890" href="simple.html#4890" class="Bound">I</a> <a id="4892" class="Symbol">:</a> <a id="4894" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4897" class="Symbol">}</a> <a id="4899" class="Symbol">→</a> <a id="4901" href="Categories.Category.Core.html#442" class="Record">Category</a> <a id="4910" class="Symbol">(</a><a id="4911" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="4915" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="4919" class="Symbol">)</a> <a id="4921" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="4926" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="4931" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="4947" class="Symbol">{</a><a id="4948" href="simple.html#4948" class="Bound">I</a><a id="4949" class="Symbol">}</a> <a id="4951" class="Symbol">=</a>
 <a id="4954" class="Keyword">record</a>
  <a id="4963" class="Symbol">{</a> <a id="4965" href="Categories.Category.Core.html#559" class="Field">Obj</a> <a id="4969" class="Symbol">=</a> <a id="4971" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="4977" class="Symbol">;</a> <a id="4979" href="Categories.Category.Core.html#575" class="Field Operator">_⇒_</a> <a id="4983" class="Symbol">=</a> <a id="4985" class="Symbol">λ</a> <a id="4987" href="simple.html#4987" class="Bound">X</a> <a id="4989" href="simple.html#4989" class="Bound">Y</a> <a id="4991" class="Symbol">→</a> <a id="4993" href="simple.html#4987" class="Bound">X</a> <a id="4995" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4997" href="simple.html#4948" class="Bound">I</a> <a id="4999" class="Symbol">→</a> <a id="5001" href="simple.html#4989" class="Bound">Y</a>
  <a id="5005" class="Symbol">;</a> <a id="5007" href="Categories.Category.Core.html#595" class="Field Operator">_≈_</a> <a id="5011" class="Symbol">=</a> <a id="5013" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>
  <a id="5019" class="Symbol">;</a> <a id="5021" href="Categories.Category.Core.html#630" class="Field">id</a> <a id="5024" class="Symbol">=</a> <a id="5026" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
  <a id="5034" class="Symbol">;</a> <a id="5036" href="Categories.Category.Core.html#656" class="Field Operator">_∘_</a> <a id="5040" class="Symbol">=</a> <a id="5042" href="simple.html#5281" class="Function Operator">_·_</a> <a id="5046" class="Comment">-- this is the Kleisli composition</a>
  <a id="5083" class="Symbol">;</a> <a id="5085" href="Categories.Category.Core.html#715" class="Field">assoc</a> <a id="5091" class="Symbol">=</a> <a id="5093" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="5100" class="Symbol">;</a> <a id="5102" href="Categories.Category.Core.html#1004" class="Field">sym-assoc</a> <a id="5112" class="Symbol">=</a> <a id="5114" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="5121" class="Symbol">;</a> <a id="5123" href="Categories.Category.Core.html#1096" class="Field">identityˡ</a> <a id="5133" class="Symbol">=</a> <a id="5135" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="5142" class="Symbol">;</a> <a id="5144" href="Categories.Category.Core.html#1145" class="Field">identityʳ</a> <a id="5154" class="Symbol">=</a> <a id="5156" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="5163" class="Symbol">;</a> <a id="5165" href="Categories.Category.Core.html#1339" class="Field">identity²</a> <a id="5175" class="Symbol">=</a> <a id="5177" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="5184" class="Symbol">;</a> <a id="5186" href="Categories.Category.Core.html#1384" class="Field">equiv</a> <a id="5192" class="Symbol">=</a> <a id="5194" class="Keyword">record</a> <a id="5201" class="Symbol">{</a> <a id="5203" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="5208" class="Symbol">=</a> <a id="5210" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="5215" class="Symbol">;</a> <a id="5217" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="5221" class="Symbol">=</a> <a id="5223" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="5227" class="Symbol">;</a> <a id="5229" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="5235" class="Symbol">=</a> <a id="5237" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="5243" class="Symbol">}</a>
  <a id="5247" class="Symbol">;</a> <a id="5249" href="Categories.Category.Core.html#1438" class="Field">∘-resp-≈</a> <a id="5258" class="Symbol">=</a> <a id="5260" href="simple.html#5396" class="Function">rresp</a>
  <a id="5268" class="Symbol">}</a>
  <a id="5272" class="Keyword">where</a>
   <a id="5281" href="simple.html#5281" class="Function Operator">_·_</a> <a id="5285" class="Symbol">:</a> <a id="5287" class="Symbol">{</a><a id="5288" href="simple.html#5288" class="Bound">I</a> <a id="5290" class="Symbol">:</a> <a id="5292" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5295" class="Symbol">}</a> <a id="5297" class="Symbol">{</a><a id="5298" href="simple.html#5298" class="Bound">A</a> <a id="5300" href="simple.html#5300" class="Bound">B</a> <a id="5302" href="simple.html#5302" class="Bound">C</a> <a id="5304" class="Symbol">:</a> <a id="5306" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5309" class="Symbol">}</a> <a id="5311" class="Symbol">→</a> <a id="5313" class="Symbol">(</a><a id="5314" href="simple.html#5300" class="Bound">B</a> <a id="5316" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5318" href="simple.html#5288" class="Bound">I</a> <a id="5320" class="Symbol">→</a> <a id="5322" href="simple.html#5302" class="Bound">C</a><a id="5323" class="Symbol">)</a> <a id="5325" class="Symbol">→</a> <a id="5327" class="Symbol">(</a><a id="5328" href="simple.html#5298" class="Bound">A</a> <a id="5330" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5332" href="simple.html#5288" class="Bound">I</a> <a id="5334" class="Symbol">→</a> <a id="5336" href="simple.html#5300" class="Bound">B</a><a id="5337" class="Symbol">)</a> <a id="5339" class="Symbol">→</a> <a id="5341" href="simple.html#5298" class="Bound">A</a> <a id="5343" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5345" href="simple.html#5288" class="Bound">I</a> <a id="5347" class="Symbol">→</a> <a id="5349" href="simple.html#5302" class="Bound">C</a>
   <a id="5354" href="simple.html#5281" class="Function Operator">_·_</a> <a id="5358" class="Symbol">{</a><a id="5359" href="simple.html#5359" class="Bound">I</a><a id="5360" class="Symbol">}</a> <a id="5362" href="simple.html#5362" class="Bound">f</a> <a id="5364" href="simple.html#5364" class="Bound">g</a> <a id="5366" class="Symbol">(</a><a id="5367" href="simple.html#5367" class="Bound">x</a> <a id="5369" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5371" href="simple.html#5371" class="Bound">i</a><a id="5372" class="Symbol">)</a> <a id="5374" class="Symbol">=</a> <a id="5376" href="simple.html#5362" class="Bound">f</a> <a id="5378" class="Symbol">(</a><a id="5379" href="simple.html#5364" class="Bound">g</a><a id="5380" class="Symbol">(</a><a id="5381" href="simple.html#5367" class="Bound">x</a> <a id="5383" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5385" href="simple.html#5371" class="Bound">i</a><a id="5386" class="Symbol">)</a> <a id="5388" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5390" href="simple.html#5371" class="Bound">i</a><a id="5391" class="Symbol">)</a>
   <a id="5396" href="simple.html#5396" class="Function">rresp</a> <a id="5402" class="Symbol">:</a> <a id="5404" class="Symbol">{</a><a id="5405" href="simple.html#5405" class="Bound">A</a> <a id="5407" href="simple.html#5407" class="Bound">B</a> <a id="5409" href="simple.html#5409" class="Bound">C</a> <a id="5411" class="Symbol">:</a> <a id="5413" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5416" class="Symbol">}</a> <a id="5418" class="Symbol">{</a><a id="5419" href="simple.html#5419" class="Bound">f</a> <a id="5421" href="simple.html#5421" class="Bound">h</a> <a id="5423" class="Symbol">:</a> <a id="5425" href="simple.html#5407" class="Bound">B</a> <a id="5427" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5429" href="simple.html#4948" class="Bound">I</a> <a id="5431" class="Symbol">→</a> <a id="5433" href="simple.html#5409" class="Bound">C</a><a id="5434" class="Symbol">}</a> <a id="5436" class="Symbol">{</a><a id="5437" href="simple.html#5437" class="Bound">g</a> <a id="5439" href="simple.html#5439" class="Bound">i</a> <a id="5441" class="Symbol">:</a> <a id="5443" href="simple.html#5405" class="Bound">A</a> <a id="5445" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5447" href="simple.html#4948" class="Bound">I</a> <a id="5449" class="Symbol">→</a> <a id="5451" href="simple.html#5407" class="Bound">B</a><a id="5452" class="Symbol">}</a> <a id="5454" class="Symbol">→</a>
    <a id="5460" href="simple.html#5419" class="Bound">f</a> <a id="5462" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5464" href="simple.html#5421" class="Bound">h</a> <a id="5466" class="Symbol">→</a> <a id="5468" href="simple.html#5437" class="Bound">g</a> <a id="5470" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5472" href="simple.html#5439" class="Bound">i</a> <a id="5474" class="Symbol">→</a> <a id="5476" class="Symbol">(</a><a id="5477" href="simple.html#5419" class="Bound">f</a> <a id="5479" href="simple.html#5281" class="Function Operator">·</a> <a id="5481" href="simple.html#5437" class="Bound">g</a><a id="5482" class="Symbol">)</a> <a id="5484" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5486" class="Symbol">(</a><a id="5487" href="simple.html#5421" class="Bound">h</a> <a id="5489" href="simple.html#5281" class="Function Operator">·</a> <a id="5491" href="simple.html#5439" class="Bound">i</a><a id="5492" class="Symbol">)</a>
   <a id="5497" href="simple.html#5396" class="Function">rresp</a> <a id="5503" class="Symbol">{</a><a id="5504" href="simple.html#5504" class="Bound">A</a><a id="5505" class="Symbol">}</a> <a id="5507" class="Symbol">{</a><a id="5508" href="simple.html#5508" class="Bound">B</a><a id="5509" class="Symbol">}</a> <a id="5511" class="Symbol">{</a><a id="5512" href="simple.html#5512" class="Bound">C</a><a id="5513" class="Symbol">}</a> <a id="5515" class="Symbol">{</a><a id="5516" href="simple.html#5516" class="Bound">f</a><a id="5517" class="Symbol">}</a> <a id="5519" class="Symbol">{</a><a id="5520" href="simple.html#5520" class="Bound">h</a><a id="5521" class="Symbol">}</a> <a id="5523" class="Symbol">{</a><a id="5524" href="simple.html#5524" class="Bound">g</a><a id="5525" class="Symbol">}</a> <a id="5527" class="Symbol">{</a><a id="5528" href="simple.html#5528" class="Bound">i</a><a id="5529" class="Symbol">}</a> <a id="5531" href="simple.html#5531" class="Bound">x</a> <a id="5533" href="simple.html#5533" class="Bound">y</a> <a id="5535" class="Symbol">=</a>
    <a id="5541" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="5547" class="Symbol">(</a><a id="5548" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="5553" class="Symbol">(λ</a> <a id="5556" href="simple.html#5556" class="Bound">t</a> <a id="5558" class="Symbol">→</a> <a id="5560" href="simple.html#5556" class="Bound">t</a> <a id="5562" href="simple.html#5281" class="Function Operator">·</a> <a id="5564" href="simple.html#5524" class="Bound">g</a><a id="5565" class="Symbol">)</a> <a id="5567" href="simple.html#5531" class="Bound">x</a><a id="5568" class="Symbol">)</a> <a id="5570" class="Symbol">(</a><a id="5571" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="5576" class="Symbol">(</a><a id="5577" href="simple.html#5281" class="Function Operator">_·_</a> <a id="5581" href="simple.html#5520" class="Bound">h</a><a id="5582" class="Symbol">)</a> <a id="5584" href="simple.html#5533" class="Bound">y</a><a id="5585" class="Symbol">)</a>
</pre>
The proof that reindexing functors exist:
<pre class="Agda"><a id="reindex"></a><a id="5637" href="simple.html#5637" class="Function">reindex</a> <a id="5645" class="Symbol">:</a> <a id="5647" class="Symbol">{</a><a id="5648" href="simple.html#5648" class="Bound">I</a> <a id="5650" href="simple.html#5650" class="Bound">J</a> <a id="5652" class="Symbol">:</a> <a id="5654" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5657" class="Symbol">}</a> <a id="5659" class="Symbol">→</a>
 <a id="5662" class="Symbol">(</a><a id="5663" href="simple.html#5663" class="Bound">u</a> <a id="5665" class="Symbol">:</a> <a id="5667" href="simple.html#5648" class="Bound">I</a> <a id="5669" class="Symbol">→</a> <a id="5671" href="simple.html#5650" class="Bound">J</a><a id="5672" class="Symbol">)</a> <a id="5674" class="Symbol">→</a>
 <a id="5677" href="Categories.Functor.Core.html#248" class="Record">Functor</a> <a id="5685" class="Symbol">(</a><a id="5686" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="5702" class="Symbol">{</a><a id="5703" href="simple.html#5650" class="Bound">J</a><a id="5704" class="Symbol">})</a> <a id="5707" class="Symbol">(</a><a id="5708" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="5724" class="Symbol">{</a><a id="5725" href="simple.html#5648" class="Bound">I</a><a id="5726" class="Symbol">})</a>
<a id="5729" href="simple.html#5637" class="Function">reindex</a> <a id="5737" class="Symbol">{</a><a id="5738" href="simple.html#5738" class="Bound">I</a><a id="5739" class="Symbol">}</a> <a id="5741" class="Symbol">{</a><a id="5742" href="simple.html#5742" class="Bound">J</a><a id="5743" class="Symbol">}</a> <a id="5745" href="simple.html#5745" class="Bound">u</a> <a id="5747" class="Symbol">=</a> <a id="5749" class="Keyword">record</a>
  <a id="5758" class="Symbol">{</a> <a id="5760" href="Categories.Functor.Core.html#432" class="Field">F₀</a> <a id="5763" class="Symbol">=</a> <a id="5765" href="simple.html#5907" class="Function">F0</a>
  <a id="5770" class="Symbol">;</a> <a id="5772" href="Categories.Functor.Core.html#455" class="Field">F₁</a> <a id="5775" class="Symbol">=</a> <a id="5777" href="simple.html#5939" class="Function">F1</a>
  <a id="5782" class="Symbol">;</a> <a id="5784" href="Categories.Functor.Core.html#511" class="Field">identity</a> <a id="5793" class="Symbol">=</a> <a id="5795" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="5802" class="Symbol">;</a> <a id="5804" href="Categories.Functor.Core.html#565" class="Field">homomorphism</a> <a id="5817" class="Symbol">=</a> <a id="5819" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="5826" class="Symbol">;</a> <a id="5828" href="Categories.Functor.Core.html#696" class="Field">F-resp-≈</a> <a id="5837" class="Symbol">=</a> <a id="5839" class="Symbol">λ</a> <a id="5841" class="Symbol">{</a><a id="5842" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="5847" class="Symbol">→</a> <a id="5849" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5853" class="Symbol">}</a>
  <a id="5857" class="Symbol">}</a>
  <a id="5861" class="Keyword">where</a>
  <a id="5869" class="Keyword">open</a> <a id="5874" href="Categories.Category.Core.html#442" class="Module">Category</a> <a id="5883" class="Symbol">(</a><a id="5884" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="5900" class="Symbol">{</a><a id="5901" href="simple.html#5742" class="Bound">J</a><a id="5902" class="Symbol">})</a>
  <a id="5907" href="simple.html#5907" class="Function">F0</a> <a id="5910" class="Symbol">:</a> <a id="5912" href="Categories.Category.Core.html#559" class="Function">Obj</a> <a id="5916" class="Symbol">→</a> <a id="5918" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="5924" href="simple.html#5907" class="Function">F0</a> <a id="5927" href="simple.html#5927" class="Bound">X</a> <a id="5929" class="Symbol">=</a> <a id="5931" href="simple.html#5927" class="Bound">X</a> <a id="5933" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5935" href="simple.html#5742" class="Bound">J</a>
  <a id="5939" href="simple.html#5939" class="Function">F1</a> <a id="5942" class="Symbol">:</a> <a id="5944" class="Symbol">{</a><a id="5945" href="simple.html#5945" class="Bound">A</a> <a id="5947" href="simple.html#5947" class="Bound">B</a> <a id="5949" class="Symbol">:</a> <a id="5951" href="Categories.Category.Core.html#559" class="Function">Obj</a><a id="5954" class="Symbol">}</a> <a id="5956" class="Symbol">→</a>
   <a id="5961" class="Symbol">(</a><a id="5962" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="5978" class="Symbol">{</a><a id="5979" href="simple.html#5742" class="Bound">J</a><a id="5980" class="Symbol">})</a> <a id="5983" href="Categories.Category.html#503" class="Function Operator">Categories.Category.[</a> <a id="6005" href="simple.html#5945" class="Bound">A</a> <a id="6007" href="Categories.Category.html#503" class="Function Operator">,</a> <a id="6009" href="simple.html#5947" class="Bound">B</a> <a id="6011" href="Categories.Category.html#503" class="Function Operator">]</a> <a id="6013" class="Symbol">→</a>
   <a id="6018" class="Symbol">(</a><a id="6019" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="6035" class="Symbol">{</a><a id="6036" href="simple.html#5738" class="Bound">I</a><a id="6037" class="Symbol">})</a> <a id="6040" href="Categories.Category.html#503" class="Function Operator">Categories.Category.[</a> <a id="6062" href="simple.html#5907" class="Function">F0</a> <a id="6065" href="simple.html#5945" class="Bound">A</a> <a id="6067" href="Categories.Category.html#503" class="Function Operator">,</a> <a id="6069" href="simple.html#5907" class="Function">F0</a> <a id="6072" href="simple.html#5947" class="Bound">B</a> <a id="6074" href="Categories.Category.html#503" class="Function Operator">]</a>
  <a id="6078" href="simple.html#5939" class="Function">F1</a> <a id="6081" class="Symbol">{</a><a id="6082" href="simple.html#6082" class="Bound">A</a><a id="6083" class="Symbol">}</a> <a id="6085" class="Symbol">{</a><a id="6086" href="simple.html#6086" class="Bound">B</a><a id="6087" class="Symbol">}</a> <a id="6089" href="simple.html#6089" class="Bound">u</a> <a id="6091" class="Symbol">((</a><a id="6093" href="simple.html#6093" class="Bound">a</a> <a id="6095" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6097" href="simple.html#6097" class="Bound">j</a><a id="6098" class="Symbol">)</a> <a id="6100" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6102" href="simple.html#6102" class="Bound">i</a><a id="6103" class="Symbol">)</a> <a id="6105" class="Symbol">=</a> <a id="6107" href="simple.html#6089" class="Bound">u</a> <a id="6109" class="Symbol">(</a><a id="6110" href="simple.html#6093" class="Bound">a</a> <a id="6112" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6114" href="simple.html#6097" class="Bound">j</a><a id="6115" class="Symbol">)</a> <a id="6117" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6119" href="simple.html#6097" class="Bound">j</a>
</pre>
<p>Now, here’s the proof that each fiber of a simple fibration is cartesian.</p>
It is moderately painful, because the record <code>CartesianCategory</code> has other records nested inside…
<pre class="Agda"><a id="fib-of-simple-cartesian"></a><a id="6304" href="simple.html#6304" class="Function">fib-of-simple-cartesian</a> <a id="6328" class="Symbol">:</a> <a id="6330" class="Symbol">∀</a> <a id="6332" class="Symbol">{</a><a id="6333" href="simple.html#6333" class="Bound">I</a> <a id="6335" class="Symbol">:</a> <a id="6337" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="6340" class="Symbol">}</a> <a id="6342" class="Symbol">→</a>
 <a id="6345" href="Categories.Category.Cartesian.Bundle.html#422" class="Record">CartesianCategory</a> <a id="6363" class="Symbol">(</a><a id="6364" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="6368" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="6372" class="Symbol">)</a> <a id="6374" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="6379" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="6384" href="simple.html#6304" class="Function">fib-of-simple-cartesian</a> <a id="6408" class="Symbol">{</a><a id="6409" href="simple.html#6409" class="Bound">I</a><a id="6410" class="Symbol">}</a> <a id="6412" class="Symbol">=</a>
 <a id="6415" class="Keyword">record</a>
  <a id="6424" class="Symbol">{</a> <a id="6426" href="Categories.Category.Cartesian.Bundle.html#488" class="Field">U</a> <a id="6428" class="Symbol">=</a> <a id="6430" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="6446" class="Symbol">{</a><a id="6447" href="simple.html#6409" class="Bound">I</a><a id="6448" class="Symbol">}</a>
  <a id="6452" class="Symbol">;</a> <a id="6454" href="Categories.Category.Cartesian.Bundle.html#540" class="Field">cartesian</a> <a id="6464" class="Symbol">=</a>
    <a id="6470" class="Keyword">record</a>
     <a id="6482" class="Symbol">{</a> <a id="6484" href="Categories.Category.Cartesian.html#777" class="Field">terminal</a> <a id="6493" class="Symbol">=</a>
       <a id="6502" class="Keyword">record</a> <a id="6509" class="Symbol">{</a> <a id="6511" href="Categories.Object.Terminal.html#905" class="Field">⊤</a> <a id="6513" class="Symbol">=</a> <a id="6515" href="simple.html#1602" class="Datatype">t</a>
           <a id="6528" class="Symbol">;</a> <a id="6530" href="Categories.Object.Terminal.html#917" class="Field">⊤-is-terminal</a> <a id="6544" class="Symbol">=</a>
             <a id="6559" class="Keyword">record</a>
              <a id="6580" class="Symbol">{</a> <a id="6582" href="Categories.Object.Terminal.html#577" class="Field">!</a> <a id="6584" class="Symbol">=</a> <a id="6586" href="Function.Base.html#716" class="Function">const</a> <a id="6592" href="simple.html#1617" class="InductiveConstructor">⊤</a>
              <a id="6608" class="Symbol">;</a> <a id="6610" href="Categories.Object.Terminal.html#605" class="Field">!-unique</a> <a id="6619" class="Symbol">=</a>
                <a id="6637" class="Symbol">λ</a> <a id="6639" href="simple.html#6639" class="Bound">f</a> <a id="6641" class="Symbol">→</a> <a id="6643" href="simple.html#1738" class="Postulate">extensionality</a> <a id="6658" class="Symbol">(λ</a> <a id="6661" href="simple.html#6661" class="Bound">x</a> <a id="6663" class="Symbol">→</a> <a id="6665" href="simple.html#1624" class="Function">!-unique-lemma</a> <a id="6680" class="Symbol">(</a><a id="6681" href="simple.html#6639" class="Bound">f</a> <a id="6683" href="simple.html#6661" class="Bound">x</a><a id="6684" class="Symbol">))</a>
              <a id="6701" class="Symbol">}</a>
           <a id="6714" class="Symbol">}</a>
     <a id="6721" class="Symbol">;</a> <a id="6723" href="Categories.Category.Cartesian.html#801" class="Field">products</a> <a id="6732" class="Symbol">=</a>
       <a id="6741" class="Keyword">record</a>
        <a id="6756" class="Symbol">{</a> <a id="6758" href="Categories.Category.BinaryProducts.html#916" class="Field">product</a> <a id="6766" class="Symbol">=</a> <a id="6768" class="Symbol">λ</a> <a id="6770" class="Symbol">{</a><a id="6771" href="simple.html#6771" class="Bound">A</a><a id="6772" class="Symbol">}</a> <a id="6774" class="Symbol">{</a><a id="6775" href="simple.html#6775" class="Bound">B</a><a id="6776" class="Symbol">}</a> <a id="6778" class="Symbol">→</a>
          <a id="6790" class="Keyword">record</a>
           <a id="6808" class="Symbol">{</a> <a id="6810" href="Categories.Object.Product.Core.html#510" class="Field">A×B</a> <a id="6814" class="Symbol">=</a> <a id="6816" href="simple.html#6771" class="Bound">A</a> <a id="6818" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6820" href="simple.html#6775" class="Bound">B</a>
           <a id="6833" class="Symbol">;</a> <a id="6835" href="Categories.Object.Product.Core.html#526" class="Field">π₁</a> <a id="6838" class="Symbol">=</a> <a id="6840" class="Symbol">λ</a> <a id="6842" href="simple.html#6842" class="Bound">x</a> <a id="6844" class="Symbol">→</a> <a id="6846" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6852" class="Symbol">(</a><a id="6853" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6859" href="simple.html#6842" class="Bound">x</a><a id="6860" class="Symbol">)</a>
           <a id="6873" class="Symbol">;</a> <a id="6875" href="Categories.Object.Product.Core.html#546" class="Field">π₂</a> <a id="6878" class="Symbol">=</a> <a id="6880" class="Symbol">λ</a> <a id="6882" href="simple.html#6882" class="Bound">x</a> <a id="6884" class="Symbol">→</a> <a id="6886" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6892" class="Symbol">(</a><a id="6893" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6899" href="simple.html#6882" class="Bound">x</a><a id="6900" class="Symbol">)</a>
           <a id="6913" class="Symbol">;</a> <a id="6915" href="Categories.Object.Product.Core.html#566" class="Field Operator">⟨_,_⟩</a> <a id="6921" class="Symbol">=</a> <a id="6923" class="Symbol">λ</a> <a id="6925" href="simple.html#6925" class="Bound">f</a> <a id="6927" href="simple.html#6927" class="Bound">g</a> <a id="6929" href="simple.html#6929" class="Bound">t</a> <a id="6931" class="Symbol">→</a> <a id="6933" href="simple.html#6925" class="Bound">f</a> <a id="6935" href="simple.html#6929" class="Bound">t</a> <a id="6937" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6939" href="simple.html#6927" class="Bound">g</a> <a id="6941" href="simple.html#6929" class="Bound">t</a>
           <a id="6954" class="Symbol">;</a> <a id="6956" href="Categories.Object.Product.Core.html#603" class="Field">project₁</a> <a id="6965" class="Symbol">=</a> <a id="6967" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
           <a id="6983" class="Symbol">;</a> <a id="6985" href="Categories.Object.Product.Core.html#637" class="Field">project₂</a> <a id="6994" class="Symbol">=</a> <a id="6996" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
           <a id="7012" class="Symbol">;</a> <a id="7014" href="Categories.Object.Product.Core.html#671" class="Field">unique</a> <a id="7021" class="Symbol">=</a> <a id="7023" class="Symbol">λ</a> <a id="7025" class="Symbol">{</a><a id="7026" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7031" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7036" class="Symbol">→</a> <a id="7038" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="7042" class="Symbol">}</a>
           <a id="7055" class="Symbol">}</a> <a id="7057" class="Symbol">}</a> <a id="7059" class="Symbol">}</a> <a id="7061" class="Symbol">}</a>
</pre>
<p>but with a little help from our friend <code>λ {refl ... refl → refl}</code>, we did it!</p>
Mimicking the same argument, just not restricted to the fiber at <code>I</code>, one proves that the entire s(𝔹) is a cartesian category.
<pre class="Agda"><a id="simple-cartesian"></a><a id="7277" href="simple.html#7277" class="Function">simple-cartesian</a> <a id="7294" class="Symbol">:</a> <a id="7296" href="Categories.Category.Cartesian.Bundle.html#422" class="Record">CartesianCategory</a> <a id="7314" class="Symbol">(</a><a id="7315" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="7319" href="Agda.Primitive.html#764" class="Primitive">zero</a><a id="7323" class="Symbol">)</a> <a id="7325" href="Agda.Primitive.html#764" class="Primitive">zero</a> <a id="7330" href="Agda.Primitive.html#764" class="Primitive">zero</a>
<a id="7335" href="simple.html#7277" class="Function">simple-cartesian</a> <a id="7352" class="Symbol">=</a> <a id="7354" class="Keyword">record</a>
 <a id="7362" class="Symbol">{</a> <a id="7364" href="Categories.Category.Cartesian.Bundle.html#488" class="Field">U</a> <a id="7366" class="Symbol">=</a> <a id="7368" href="simple.html#3929" class="Function">simple</a>
 <a id="7376" class="Symbol">;</a> <a id="7378" href="Categories.Category.Cartesian.Bundle.html#540" class="Field">cartesian</a> <a id="7388" class="Symbol">=</a> <a id="7390" class="Keyword">record</a>
   <a id="7400" class="Symbol">{</a> <a id="7402" href="Categories.Category.Cartesian.html#777" class="Field">terminal</a> <a id="7411" class="Symbol">=</a> <a id="7413" class="Keyword">record</a>
    <a id="7424" class="Symbol">{</a> <a id="7426" href="Categories.Object.Terminal.html#905" class="Field">⊤</a> <a id="7428" class="Symbol">=</a> <a id="7430" href="simple.html#1602" class="Datatype">t</a> <a id="7432" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7434" href="simple.html#1602" class="Datatype">t</a>
    <a id="7440" class="Symbol">;</a> <a id="7442" href="Categories.Object.Terminal.html#917" class="Field">⊤-is-terminal</a> <a id="7456" class="Symbol">=</a>
      <a id="7464" class="Keyword">record</a> <a id="7471" class="Symbol">{</a> <a id="7473" href="Categories.Object.Terminal.html#577" class="Field">!</a> <a id="7475" class="Symbol">=</a> <a id="7477" href="Function.Base.html#716" class="Function">const</a> <a id="7483" href="simple.html#1617" class="InductiveConstructor">⊤</a> <a id="7485" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7487" href="Function.Base.html#716" class="Function">const</a> <a id="7493" href="simple.html#1617" class="InductiveConstructor">⊤</a>
             <a id="7508" class="Symbol">;</a> <a id="7510" href="Categories.Object.Terminal.html#605" class="Field">!-unique</a> <a id="7519" class="Symbol">=</a> <a id="7521" href="simple.html#7893" class="Function">bang-uniq</a>
             <a id="7544" class="Symbol">}</a> <a id="7546" class="Symbol">}</a>
   <a id="7551" class="Symbol">;</a> <a id="7553" href="Categories.Category.Cartesian.html#801" class="Field">products</a> <a id="7562" class="Symbol">=</a> <a id="7564" class="Keyword">record</a> <a id="7571" class="Symbol">{</a> <a id="7573" href="Categories.Category.BinaryProducts.html#916" class="Field">product</a> <a id="7581" class="Symbol">=</a> <a id="7583" class="Symbol">λ</a> <a id="7585" class="Symbol">{</a><a id="7586" href="simple.html#7586" class="Bound">A</a><a id="7587" class="Symbol">}</a> <a id="7589" class="Symbol">{</a><a id="7590" href="simple.html#7590" class="Bound">B</a><a id="7591" class="Symbol">}</a> <a id="7593" class="Symbol">→</a> <a id="7595" class="Keyword">record</a>
    <a id="7606" class="Symbol">{</a> <a id="7608" href="Categories.Object.Product.Core.html#510" class="Field">A×B</a> <a id="7612" class="Symbol">=</a> <a id="7614" class="Symbol">(</a><a id="7615" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7621" href="simple.html#7586" class="Bound">A</a> <a id="7623" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7625" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7631" href="simple.html#7590" class="Bound">B</a><a id="7632" class="Symbol">)</a> <a id="7634" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7636" class="Symbol">(</a><a id="7637" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="7643" href="simple.html#7586" class="Bound">A</a> <a id="7645" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7647" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="7653" href="simple.html#7590" class="Bound">B</a><a id="7654" class="Symbol">)</a>
    <a id="7660" class="Symbol">;</a> <a id="7662" href="Categories.Object.Product.Core.html#526" class="Field">π₁</a> <a id="7665" class="Symbol">=</a> <a id="7667" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7673" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7675" class="Symbol">λ</a> <a id="7677" href="simple.html#7677" class="Bound">x</a> <a id="7679" class="Symbol">→</a> <a id="7681" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7687" class="Symbol">(</a><a id="7688" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7694" href="simple.html#7677" class="Bound">x</a><a id="7695" class="Symbol">)</a>
    <a id="7701" class="Symbol">;</a> <a id="7703" href="Categories.Object.Product.Core.html#546" class="Field">π₂</a> <a id="7706" class="Symbol">=</a> <a id="7708" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="7714" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7716" class="Symbol">(λ</a> <a id="7719" href="simple.html#7719" class="Bound">x</a> <a id="7721" class="Symbol">→</a> <a id="7723" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="7729" class="Symbol">(</a><a id="7730" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7736" href="simple.html#7719" class="Bound">x</a><a id="7737" class="Symbol">))</a>
    <a id="7744" class="Symbol">;</a> <a id="7746" href="Categories.Object.Product.Core.html#566" class="Field Operator">⟨_,_⟩</a> <a id="7752" class="Symbol">=</a> <a id="7754" href="simple.html#8245" class="Function Operator">⟨_,_⟩</a>
    <a id="7764" class="Symbol">;</a> <a id="7766" href="Categories.Object.Product.Core.html#603" class="Field">project₁</a> <a id="7775" class="Symbol">=</a> <a id="7777" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="7786" class="Symbol">;</a> <a id="7788" href="Categories.Object.Product.Core.html#637" class="Field">project₂</a> <a id="7797" class="Symbol">=</a> <a id="7799" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="7808" class="Symbol">;</a> <a id="7810" href="Categories.Object.Product.Core.html#671" class="Field">unique</a> <a id="7817" class="Symbol">=</a> <a id="7819" class="Symbol">λ</a> <a id="7821" class="Symbol">{</a><a id="7822" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7827" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7832" class="Symbol">→</a> <a id="7834" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="7838" class="Symbol">}</a>
    <a id="7844" class="Symbol">}</a> <a id="7846" class="Symbol">}</a> <a id="7848" class="Symbol">}</a> <a id="7850" class="Symbol">}</a>
    <a id="7856" class="Keyword">where</a>
     <a id="7867" class="Keyword">open</a> <a id="7872" href="Categories.Category.Core.html#442" class="Module">Category</a> <a id="7881" href="simple.html#3929" class="Function">simple</a>
     <a id="7893" href="simple.html#7893" class="Function">bang-uniq</a> <a id="7903" class="Symbol">:</a>
      <a id="7911" class="Symbol">{</a><a id="7912" href="simple.html#7912" class="Bound">A</a> <a id="7914" class="Symbol">:</a> <a id="7916" href="Categories.Category.Core.html#559" class="Function">Obj</a><a id="7919" class="Symbol">}</a>
      <a id="7927" class="Comment">-------------------------</a>
      <a id="7959" class="Symbol">(</a><a id="7960" href="simple.html#7960" class="Bound">f</a> <a id="7962" class="Symbol">:</a> <a id="7964" href="simple.html#7912" class="Bound">A</a> <a id="7966" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="7968" class="Symbol">(</a><a id="7969" href="simple.html#1602" class="Datatype">t</a> <a id="7971" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7973" href="simple.html#1602" class="Datatype">t</a><a id="7974" class="Symbol">))</a> <a id="7977" class="Symbol">→</a>
      <a id="7985" class="Comment">--------------------------------------</a>
      <a id="8030" class="Symbol">(</a><a id="8031" href="simple.html#3929" class="Function">simple</a> <a id="8038" href="Categories.Category.Core.html#595" class="Field Operator">Category.≈</a> <a id="8049" class="Symbol">(</a><a id="8050" href="Function.Base.html#716" class="Function">const</a> <a id="8056" href="simple.html#1617" class="InductiveConstructor">⊤</a> <a id="8058" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8060" href="Function.Base.html#716" class="Function">const</a> <a id="8066" href="simple.html#1617" class="InductiveConstructor">⊤</a><a id="8067" class="Symbol">))</a> <a id="8070" href="simple.html#7960" class="Bound">f</a>
     <a id="8077" href="simple.html#7893" class="Function">bang-uniq</a> <a id="8087" class="Symbol">{</a><a id="8088" href="simple.html#8088" class="Bound">I</a> <a id="8090" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8092" href="simple.html#8092" class="Bound">X</a><a id="8093" class="Symbol">}</a> <a id="8095" class="Symbol">(</a><a id="8096" href="simple.html#8096" class="Bound">u</a> <a id="8098" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8100" href="simple.html#8100" class="Bound">k</a><a id="8101" class="Symbol">)</a> <a id="8103" class="Symbol">=</a>
      <a id="8111" href="Relation.Binary.PropositionalEquality.Core.html#1367" class="Function">cong₂</a> <a id="8117" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">Data.Product._,_</a>
       <a id="8141" class="Symbol">(</a><a id="8142" href="simple.html#1738" class="Postulate">extensionality</a> <a id="8157" class="Symbol">(λ</a> <a id="8160" href="simple.html#8160" class="Bound">x</a> <a id="8162" class="Symbol">→</a> <a id="8164" href="simple.html#1624" class="Function">!-unique-lemma</a> <a id="8179" class="Symbol">(</a><a id="8180" href="simple.html#8096" class="Bound">u</a> <a id="8182" href="simple.html#8160" class="Bound">x</a><a id="8183" class="Symbol">)))</a>
       <a id="8194" class="Symbol">(</a><a id="8195" href="simple.html#1738" class="Postulate">extensionality</a> <a id="8210" class="Symbol">(λ</a> <a id="8213" href="simple.html#8213" class="Bound">x</a> <a id="8215" class="Symbol">→</a> <a id="8217" href="simple.html#1624" class="Function">!-unique-lemma</a> <a id="8232" class="Symbol">(</a><a id="8233" href="simple.html#8100" class="Bound">k</a> <a id="8235" href="simple.html#8213" class="Bound">x</a><a id="8236" class="Symbol">)))</a>
     <a id="8245" href="simple.html#8245" class="Function Operator">⟨_,_⟩</a> <a id="8251" class="Symbol">:</a>
      <a id="8259" class="Symbol">{</a><a id="8260" href="simple.html#8260" class="Bound">A</a> <a id="8262" href="simple.html#8262" class="Bound">B</a> <a id="8264" href="simple.html#8264" class="Bound">C</a> <a id="8266" class="Symbol">:</a> <a id="8268" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="8272" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8274" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="8277" class="Symbol">}</a> <a id="8279" class="Symbol">→</a>
      <a id="8287" href="simple.html#8264" class="Bound">C</a> <a id="8289" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="8291" href="simple.html#8260" class="Bound">A</a> <a id="8293" class="Symbol">→</a>
      <a id="8301" href="simple.html#8264" class="Bound">C</a> <a id="8303" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="8305" href="simple.html#8262" class="Bound">B</a> <a id="8307" class="Symbol">→</a>
      <a id="8315" href="simple.html#8264" class="Bound">C</a> <a id="8317" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="8319" class="Symbol">((</a><a id="8321" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8327" href="simple.html#8260" class="Bound">A</a> <a id="8329" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8331" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8337" href="simple.html#8262" class="Bound">B</a><a id="8338" class="Symbol">)</a> <a id="8340" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8342" class="Symbol">(</a><a id="8343" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8349" href="simple.html#8260" class="Bound">A</a> <a id="8351" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8353" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8359" href="simple.html#8262" class="Bound">B</a><a id="8360" class="Symbol">))</a>
     <a id="8368" href="simple.html#8245" class="Function Operator">⟨_,_⟩</a> <a id="8374" class="Symbol">{</a><a id="8375" href="simple.html#8375" class="Bound">A0</a> <a id="8378" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8380" href="simple.html#8380" class="Bound">A1</a><a id="8382" class="Symbol">}</a> <a id="8384" class="Symbol">{</a><a id="8385" href="simple.html#8385" class="Bound">B0</a> <a id="8388" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8390" href="simple.html#8390" class="Bound">B1</a><a id="8392" class="Symbol">}</a> <a id="8394" class="Symbol">{</a><a id="8395" href="simple.html#8395" class="Bound">C0</a> <a id="8398" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8400" href="simple.html#8400" class="Bound">C1</a><a id="8402" class="Symbol">}</a> <a id="8404" class="Symbol">(</a><a id="8405" href="simple.html#8405" class="Bound">u</a> <a id="8407" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8409" href="simple.html#8409" class="Bound">h</a><a id="8410" class="Symbol">)</a> <a id="8412" class="Symbol">(</a><a id="8413" href="simple.html#8413" class="Bound">v</a> <a id="8415" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8417" href="simple.html#8417" class="Bound">k</a><a id="8418" class="Symbol">)</a> <a id="8420" class="Symbol">=</a>
      <a id="8428" class="Symbol">(λ</a> <a id="8431" href="simple.html#8431" class="Bound">x</a> <a id="8433" class="Symbol">→</a> <a id="8435" class="Symbol">(</a><a id="8436" href="simple.html#8405" class="Bound">u</a> <a id="8438" href="simple.html#8431" class="Bound">x</a><a id="8439" class="Symbol">)</a> <a id="8441" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8443" class="Symbol">(</a><a id="8444" href="simple.html#8413" class="Bound">v</a> <a id="8446" href="simple.html#8431" class="Bound">x</a><a id="8447" class="Symbol">))</a> <a id="8450" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8452" class="Symbol">λ</a> <a id="8454" href="simple.html#8454" class="Bound">x</a> <a id="8456" class="Symbol">→</a> <a id="8458" class="Symbol">(</a><a id="8459" href="simple.html#8409" class="Bound">h</a> <a id="8461" href="simple.html#8454" class="Bound">x</a><a id="8462" class="Symbol">)</a> <a id="8464" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8466" class="Symbol">(</a><a id="8467" href="simple.html#8417" class="Bound">k</a> <a id="8469" href="simple.html#8454" class="Bound">x</a><a id="8470" class="Symbol">)</a>
</pre>
<p>…the biggest pain was to indent the code in a logical way.</p>
And now for the proof that each fiber of <code>U : s(𝔹) → 𝔹</code> is cartesian closed:
<pre class="Agda"><a id="fib-of-simple-ccc"></a><a id="8619" href="simple.html#8619" class="Function">fib-of-simple-ccc</a> <a id="8637" class="Symbol">:</a> <a id="8639" class="Symbol">{</a><a id="8640" href="simple.html#8640" class="Bound">I</a> <a id="8642" class="Symbol">:</a> <a id="8644" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="8647" class="Symbol">}</a> <a id="8649" class="Symbol">→</a> <a id="8651" href="Categories.Category.CartesianClosed.Canonical.html#1539" class="Record">CartesianClosed</a> <a id="8667" class="Symbol">(</a><a id="8668" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="8684" class="Symbol">{</a><a id="8685" href="simple.html#8640" class="Bound">I</a><a id="8686" class="Symbol">})</a>
<a id="8689" href="simple.html#8619" class="Function">fib-of-simple-ccc</a> <a id="8707" class="Symbol">{</a><a id="8708" href="simple.html#8708" class="Bound">I</a><a id="8709" class="Symbol">}</a> <a id="8711" class="Symbol">=</a>
 <a id="8714" class="Keyword">record</a>
  <a id="8723" class="Symbol">{</a> <a id="8725" href="Categories.Category.CartesianClosed.Canonical.html#1671" class="Field">⊤</a> <a id="8727" class="Symbol">=</a> <a id="8729" href="simple.html#1602" class="Datatype">t</a>
  <a id="8733" class="Symbol">;</a> <a id="8735" href="Categories.Category.CartesianClosed.Canonical.html#1686" class="Field Operator">_×_</a> <a id="8739" class="Symbol">=</a> <a id="8741" href="Data.Product.html#1167" class="Function Operator">_×_</a>
  <a id="8747" class="Symbol">;</a> <a id="8749" href="Categories.Category.CartesianClosed.Canonical.html#1714" class="Field">!</a> <a id="8751" class="Symbol">=</a> <a id="8753" class="Symbol">λ</a> <a id="8755" href="simple.html#8755" class="Bound">x</a> <a id="8757" class="Symbol">→</a> <a id="8759" href="simple.html#1617" class="InductiveConstructor">⊤</a>
  <a id="8763" class="Symbol">;</a> <a id="8765" href="Categories.Category.CartesianClosed.Canonical.html#1732" class="Field">π₁</a> <a id="8768" class="Symbol">=</a> <a id="8770" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8776" href="simple.html#1281" class="Function Operator">⋆</a> <a id="8778" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
  <a id="8786" class="Symbol">;</a> <a id="8788" href="Categories.Category.CartesianClosed.Canonical.html#1754" class="Field">π₂</a> <a id="8791" class="Symbol">=</a> <a id="8793" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8799" href="simple.html#1281" class="Function Operator">⋆</a> <a id="8801" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
  <a id="8809" class="Symbol">;</a> <a id="8811" href="Categories.Category.CartesianClosed.Canonical.html#1776" class="Field Operator">⟨_,_⟩</a> <a id="8817" class="Symbol">=</a> <a id="8819" class="Symbol">λ</a> <a id="8821" href="simple.html#8821" class="Bound">f</a> <a id="8823" href="simple.html#8823" class="Bound">g</a> <a id="8825" href="simple.html#8825" class="Bound">ci</a> <a id="8828" class="Symbol">→</a> <a id="8830" class="Symbol">(</a><a id="8831" href="simple.html#8821" class="Bound">f</a> <a id="8833" href="simple.html#8825" class="Bound">ci</a><a id="8835" class="Symbol">)</a> <a id="8837" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8839" class="Symbol">(</a><a id="8840" href="simple.html#8823" class="Bound">g</a> <a id="8842" href="simple.html#8825" class="Bound">ci</a><a id="8844" class="Symbol">)</a>
  <a id="8848" class="Symbol">;</a> <a id="8850" href="Categories.Category.CartesianClosed.Canonical.html#1815" class="Field">!-unique</a> <a id="8859" class="Symbol">=</a> <a id="8861" class="Symbol">λ</a> <a id="8863" href="simple.html#8863" class="Bound">f</a> <a id="8865" class="Symbol">→</a> <a id="8867" href="simple.html#1738" class="Postulate">extensionality</a> <a id="8882" class="Symbol">λ</a> <a id="8884" href="simple.html#8884" class="Bound">x</a> <a id="8886" class="Symbol">→</a> <a id="8888" href="simple.html#1624" class="Function">!-unique-lemma</a> <a id="8903" class="Symbol">(</a><a id="8904" href="simple.html#8863" class="Bound">f</a> <a id="8906" href="simple.html#8884" class="Bound">x</a><a id="8907" class="Symbol">)</a>
  <a id="8911" class="Symbol">;</a> <a id="8913" href="Categories.Category.CartesianClosed.Canonical.html#1851" class="Field">π₁-comp</a> <a id="8921" class="Symbol">=</a> <a id="8923" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="8930" class="Symbol">;</a> <a id="8932" href="Categories.Category.CartesianClosed.Canonical.html#1885" class="Field">π₂-comp</a> <a id="8940" class="Symbol">=</a> <a id="8942" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="8949" class="Symbol">;</a> <a id="8951" href="Categories.Category.CartesianClosed.Canonical.html#1920" class="Field">⟨,⟩-unique</a> <a id="8962" class="Symbol">=</a> <a id="8964" class="Symbol">λ</a> <a id="8966" class="Symbol">{</a><a id="8967" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="8972" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="8977" class="Symbol">→</a> <a id="8979" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="8983" class="Symbol">}</a>
  <a id="8987" class="Symbol">;</a> <a id="8989" href="Categories.Category.CartesianClosed.Canonical.html#2601" class="Field Operator">_^_</a> <a id="8993" class="Symbol">=</a> <a id="8995" class="Symbol">λ</a> <a id="8997" href="simple.html#8997" class="Bound">A</a> <a id="8999" href="simple.html#8999" class="Bound">B</a> <a id="9001" class="Symbol">→</a> <a id="9003" href="simple.html#8999" class="Bound">B</a> <a id="9005" class="Symbol">→</a> <a id="9007" href="simple.html#8997" class="Bound">A</a>
  <a id="9011" class="Symbol">;</a> <a id="9013" href="Categories.Category.CartesianClosed.Canonical.html#2629" class="Field">eval</a> <a id="9018" class="Symbol">=</a> <a id="9020" href="simple.html#9225" class="Function">evev</a>
  <a id="9027" class="Symbol">;</a> <a id="9029" href="Categories.Category.CartesianClosed.Canonical.html#2655" class="Field">curry</a> <a id="9035" class="Symbol">=</a> <a id="9037" class="Symbol">λ</a> <a id="9039" href="simple.html#9039" class="Bound">f</a> <a id="9041" href="simple.html#9041" class="Bound">ci</a> <a id="9044" href="simple.html#9044" class="Bound">a</a> <a id="9046" class="Symbol">→</a> <a id="9048" href="simple.html#9039" class="Bound">f</a> <a id="9050" class="Symbol">(((</a><a id="9053" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9059" href="simple.html#9041" class="Bound">ci</a><a id="9061" class="Symbol">)</a> <a id="9063" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9065" href="simple.html#9044" class="Bound">a</a><a id="9066" class="Symbol">)</a> <a id="9068" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9070" class="Symbol">(</a><a id="9071" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="9077" href="simple.html#9041" class="Bound">ci</a><a id="9079" class="Symbol">))</a>
  <a id="9084" class="Symbol">;</a> <a id="9086" href="Categories.Category.CartesianClosed.Canonical.html#2690" class="Field">eval-comp</a> <a id="9096" class="Symbol">=</a> <a id="9098" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="9105" class="Symbol">;</a> <a id="9107" href="Categories.Category.CartesianClosed.Canonical.html#2734" class="Field">curry-resp-≈</a> <a id="9120" class="Symbol">=</a> <a id="9122" class="Symbol">λ</a> <a id="9124" class="Symbol">{</a><a id="9125" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="9130" class="Symbol">→</a> <a id="9132" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="9136" class="Symbol">}</a>
  <a id="9140" class="Symbol">;</a> <a id="9142" href="Categories.Category.CartesianClosed.Canonical.html#2779" class="Field">curry-unique</a> <a id="9155" class="Symbol">=</a> <a id="9157" class="Symbol">λ</a> <a id="9159" class="Symbol">{</a><a id="9160" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="9165" class="Symbol">→</a> <a id="9167" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="9171" class="Symbol">}</a>
  <a id="9175" class="Symbol">}</a>
  <a id="9179" class="Keyword">where</a>
  <a id="9187" class="Keyword">open</a> <a id="9192" href="Categories.Category.Core.html#442" class="Module">Category</a> <a id="9201" class="Symbol">(</a><a id="9202" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="9218" class="Symbol">{</a><a id="9219" href="simple.html#8708" class="Bound">I</a><a id="9220" class="Symbol">})</a>
  <a id="9225" href="simple.html#9225" class="Function">evev</a> <a id="9230" class="Symbol">:</a> <a id="9232" class="Symbol">{</a><a id="9233" href="simple.html#9233" class="Bound">B</a> <a id="9235" href="simple.html#9235" class="Bound">A</a> <a id="9237" class="Symbol">:</a> <a id="9239" href="Categories.Category.Core.html#559" class="Function">Obj</a><a id="9242" class="Symbol">}</a> <a id="9244" class="Symbol">→</a> <a id="9246" class="Symbol">((</a><a id="9248" href="simple.html#9235" class="Bound">A</a> <a id="9250" class="Symbol">→</a> <a id="9252" href="simple.html#9233" class="Bound">B</a><a id="9253" class="Symbol">)</a> <a id="9255" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="9257" href="simple.html#9235" class="Bound">A</a><a id="9258" class="Symbol">)</a> <a id="9260" href="Categories.Category.Core.html#575" class="Function Operator">⇒</a> <a id="9262" href="simple.html#9233" class="Bound">B</a>
  <a id="9266" href="simple.html#9225" class="Function">evev</a> <a id="9271" class="Symbol">((</a><a id="9273" href="simple.html#9273" class="Bound">f</a> <a id="9275" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9277" href="simple.html#9277" class="Bound">a</a><a id="9278" class="Symbol">)</a> <a id="9280" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9282" href="simple.html#9282" class="Bound">i</a><a id="9283" class="Symbol">)</a> <a id="9285" class="Symbol">=</a> <a id="9287" href="simple.html#9273" class="Bound">f</a> <a id="9289" href="simple.html#9277" class="Bound">a</a>
</pre>
<p>Another interesting exercise is the following: for every category with finite products, the categories <code>𝔹//I</code> and <code>𝔹/I</code> admit equivalent presentations as, respectively, the coKleisli and the coEilenberg-Moore categories of the comonad <code>_ × I</code>.</p>
<p>First, let’s summon the <code>Comonad</code> module:</p>
<pre class="Agda"><a id="9588" class="Keyword">open</a> <a id="9593" class="Keyword">import</a> <a id="9600" href="Categories.Comonad.html" class="Module">Categories.Comonad</a>
</pre>
and prove that the functor <code>_ × I</code> is a comonad, providing all the structure.
<pre class="Agda"><a id="─×_"></a><a id="9705" href="simple.html#9705" class="Function Operator">─×_</a> <a id="9709" class="Symbol">:</a> <a id="9711" class="Symbol">(</a><a id="9712" href="simple.html#9712" class="Bound">I</a> <a id="9714" class="Symbol">:</a> <a id="9716" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="9719" class="Symbol">)</a> <a id="9721" class="Symbol">→</a> <a id="9723" href="Categories.Comonad.html#456" class="Record">Comonad</a> <a id="9731" href="simple.html#1883" class="Function">SetC</a>
<a id="9736" href="simple.html#9705" class="Function Operator">─×</a> <a id="9739" href="simple.html#9739" class="Bound">I</a> <a id="9741" class="Symbol">=</a>
 <a id="9744" class="Keyword">record</a>
  <a id="9753" class="Symbol">{</a> <a id="9755" href="Categories.Comonad.html#529" class="Field">F</a> <a id="9757" class="Symbol">=</a> <a id="9759" href="simple.html#9885" class="Function">F</a> <a id="9761" class="Symbol">{</a><a id="9762" href="simple.html#9739" class="Bound">I</a><a id="9763" class="Symbol">}</a>
  <a id="9767" class="Symbol">;</a> <a id="9769" href="Categories.Comonad.html#551" class="Field">ε</a> <a id="9771" class="Symbol">=</a> <a id="9773" href="simple.html#10095" class="Function">eps</a>
  <a id="9779" class="Symbol">;</a> <a id="9781" href="Categories.Comonad.html#587" class="Field">δ</a> <a id="9783" class="Symbol">=</a> <a id="9785" href="simple.html#10262" class="Function">comul</a>
  <a id="9793" class="Symbol">;</a> <a id="9795" href="Categories.Comonad.html#771" class="Field">assoc</a> <a id="9801" class="Symbol">=</a> <a id="9803" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="9810" class="Symbol">;</a> <a id="9812" href="Categories.Comonad.html#841" class="Field">sym-assoc</a> <a id="9822" class="Symbol">=</a> <a id="9824" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="9831" class="Symbol">;</a> <a id="9833" href="Categories.Comonad.html#911" class="Field">identityˡ</a> <a id="9843" class="Symbol">=</a> <a id="9845" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="9852" class="Symbol">;</a> <a id="9854" href="Categories.Comonad.html#965" class="Field">identityʳ</a> <a id="9864" class="Symbol">=</a> <a id="9866" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="9873" class="Symbol">}</a>
  <a id="9877" class="Keyword">where</a>
  <a id="9885" href="simple.html#9885" class="Function">F</a> <a id="9887" class="Symbol">:</a> <a id="9889" class="Symbol">{</a><a id="9890" href="simple.html#9890" class="Bound">I</a> <a id="9892" class="Symbol">:</a> <a id="9894" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="9897" class="Symbol">}</a> <a id="9899" class="Symbol">→</a> <a id="9901" href="Categories.Functor.html#283" class="Function">Endofunctor</a> <a id="9913" href="simple.html#1883" class="Function">SetC</a>
  <a id="9920" href="simple.html#9885" class="Function">F</a> <a id="9922" class="Symbol">{</a><a id="9923" href="simple.html#9923" class="Bound">I</a><a id="9924" class="Symbol">}</a> <a id="9926" class="Symbol">=</a>
   <a id="9931" class="Keyword">record</a>
    <a id="9942" class="Symbol">{</a> <a id="9944" href="Categories.Functor.Core.html#432" class="Field">F₀</a> <a id="9947" class="Symbol">=</a> <a id="9949" class="Symbol">λ</a> <a id="9951" href="simple.html#9951" class="Bound">A</a> <a id="9953" class="Symbol">→</a> <a id="9955" href="simple.html#9951" class="Bound">A</a> <a id="9957" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="9959" href="simple.html#9923" class="Bound">I</a>
    <a id="9965" class="Symbol">;</a> <a id="9967" href="Categories.Functor.Core.html#455" class="Field">F₁</a> <a id="9970" class="Symbol">=</a> <a id="9972" class="Symbol">λ</a> <a id="9974" href="simple.html#9974" class="Bound">f</a> <a id="9976" href="simple.html#9976" class="Bound">x</a> <a id="9978" class="Symbol">→</a> <a id="9980" class="Symbol">(</a><a id="9981" href="simple.html#9974" class="Bound">f</a> <a id="9983" class="Symbol">(</a><a id="9984" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9990" href="simple.html#9976" class="Bound">x</a><a id="9991" class="Symbol">))</a> <a id="9994" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9996" class="Symbol">(</a><a id="9997" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10003" href="simple.html#9976" class="Bound">x</a><a id="10004" class="Symbol">)</a>
    <a id="10010" class="Symbol">;</a> <a id="10012" href="Categories.Functor.Core.html#511" class="Field">identity</a> <a id="10021" class="Symbol">=</a> <a id="10023" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="10032" class="Symbol">;</a> <a id="10034" href="Categories.Functor.Core.html#565" class="Field">homomorphism</a> <a id="10047" class="Symbol">=</a> <a id="10049" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="10058" class="Symbol">;</a> <a id="10060" href="Categories.Functor.Core.html#696" class="Field">F-resp-≈</a> <a id="10069" class="Symbol">=</a> <a id="10071" class="Symbol">λ</a> <a id="10073" class="Symbol">{</a><a id="10074" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10079" class="Symbol">→</a> <a id="10081" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10085" class="Symbol">}</a>
    <a id="10091" class="Symbol">}</a>
  <a id="10095" href="simple.html#10095" class="Function">eps</a> <a id="10099" class="Symbol">:</a> <a id="10101" href="Categories.NaturalTransformation.Core.html#466" class="Record">NT.NaturalTransformation</a> <a id="10126" class="Symbol">(</a><a id="10127" href="simple.html#9885" class="Function">F</a> <a id="10129" class="Symbol">{</a><a id="10130" href="simple.html#9739" class="Bound">I</a><a id="10131" class="Symbol">})</a> <a id="10134" href="Categories.Functor.html#349" class="Function">Categories.Functor.id</a>
  <a id="10158" href="simple.html#10095" class="Function">eps</a> <a id="10162" class="Symbol">=</a>
   <a id="10167" class="Keyword">record</a>
    <a id="10178" class="Symbol">{</a> <a id="10180" href="Categories.NaturalTransformation.Core.html#783" class="Field">η</a> <a id="10182" class="Symbol">=</a> <a id="10184" class="Symbol">λ</a> <a id="10186" href="simple.html#10186" class="Bound">X</a> <a id="10188" href="simple.html#10188" class="Bound">x</a> <a id="10190" class="Symbol">→</a> <a id="10192" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="10198" href="simple.html#10188" class="Bound">x</a>
    <a id="10204" class="Symbol">;</a> <a id="10206" href="Categories.NaturalTransformation.Core.html#827" class="Field">commute</a> <a id="10214" class="Symbol">=</a> <a id="10216" class="Symbol">λ</a> <a id="10218" href="simple.html#10218" class="Bound">f</a> <a id="10220" class="Symbol">→</a> <a id="10222" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="10231" class="Symbol">;</a> <a id="10233" href="Categories.NaturalTransformation.Core.html#1043" class="Field">sym-commute</a> <a id="10245" class="Symbol">=</a> <a id="10247" class="Symbol">λ</a> <a id="10249" href="simple.html#10249" class="Bound">f</a> <a id="10251" class="Symbol">→</a> <a id="10253" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10258" class="Symbol">}</a>
  <a id="10262" href="simple.html#10262" class="Function">comul</a> <a id="10268" class="Symbol">:</a> <a id="10270" href="Categories.NaturalTransformation.Core.html#466" class="Record">NT.NaturalTransformation</a> <a id="10295" class="Symbol">(</a><a id="10296" href="simple.html#9885" class="Function">F</a> <a id="10298" class="Symbol">{</a><a id="10299" href="simple.html#9739" class="Bound">I</a><a id="10300" class="Symbol">})</a> <a id="10303" class="Symbol">((</a><a id="10305" href="simple.html#9885" class="Function">F</a> <a id="10307" class="Symbol">{</a><a id="10308" href="simple.html#9739" class="Bound">I</a><a id="10309" class="Symbol">})</a> <a id="10312" href="Categories.Functor.html#747" class="Function Operator">∘F</a> <a id="10315" class="Symbol">(</a><a id="10316" href="simple.html#9885" class="Function">F</a> <a id="10318" class="Symbol">{</a><a id="10319" href="simple.html#9739" class="Bound">I</a><a id="10320" class="Symbol">}))</a>
  <a id="10326" href="simple.html#10262" class="Function">comul</a> <a id="10332" class="Symbol">=</a>
   <a id="10337" class="Keyword">record</a>
    <a id="10348" class="Symbol">{</a> <a id="10350" href="Categories.NaturalTransformation.Core.html#783" class="Field">η</a> <a id="10352" class="Symbol">=</a> <a id="10354" class="Symbol">λ</a> <a id="10356" href="simple.html#10356" class="Bound">X</a> <a id="10358" href="simple.html#10358" class="Bound">x</a> <a id="10360" class="Symbol">→</a> <a id="10362" href="simple.html#10358" class="Bound">x</a> <a id="10364" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10366" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10372" href="simple.html#10358" class="Bound">x</a>
    <a id="10378" class="Symbol">;</a> <a id="10380" href="Categories.NaturalTransformation.Core.html#827" class="Field">commute</a> <a id="10388" class="Symbol">=</a> <a id="10390" class="Symbol">λ</a> <a id="10392" href="simple.html#10392" class="Bound">f</a> <a id="10394" class="Symbol">→</a> <a id="10396" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="10405" class="Symbol">;</a> <a id="10407" href="Categories.NaturalTransformation.Core.html#1043" class="Field">sym-commute</a> <a id="10419" class="Symbol">=</a> <a id="10421" class="Symbol">λ</a> <a id="10423" href="simple.html#10423" class="Bound">f</a> <a id="10425" class="Symbol">→</a> <a id="10427" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10432" class="Symbol">}</a>
</pre>
<p>Easy as co-pie! Now, where is the <code>coKleisli</code> module…? Oh, you say you don’t have it yet.</p>
<p>[…a few weeks of frantic, painful agda sessions later…]</p>
<p>tada!</p>
<pre class="Agda"><a id="10603" class="Keyword">open</a> <a id="10608" class="Keyword">import</a> <a id="10615" href="Categories.Category.Construction.CoKleisli.html" class="Module">Categories.Category.Construction.CoKleisli</a>

<a id="fiber-of-simple≃CoKleisli─×I"></a><a id="10659" href="simple.html#10659" class="Function">fiber-of-simple≃CoKleisli─×I</a> <a id="10688" class="Symbol">:</a> <a id="10690" class="Symbol">{</a><a id="10691" href="simple.html#10691" class="Bound">I</a> <a id="10693" class="Symbol">:</a> <a id="10695" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="10698" class="Symbol">}</a> <a id="10700" class="Symbol">→</a>
  <a id="10704" href="Categories.Category.Equivalence.html#1000" class="Record">E.StrongEquivalence</a> <a id="10724" class="Symbol">(</a><a id="10725" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="10741" class="Symbol">{</a><a id="10742" href="simple.html#10691" class="Bound">I</a><a id="10743" class="Symbol">})</a> <a id="10746" class="Symbol">(</a><a id="10747" href="Categories.Category.Construction.CoKleisli.html#439" class="Function">CoKleisli</a> <a id="10757" class="Symbol">(</a><a id="10758" href="simple.html#9705" class="Function Operator">─×</a> <a id="10761" href="simple.html#10691" class="Bound">I</a><a id="10762" class="Symbol">))</a>
<a id="10765" href="simple.html#10659" class="Function">fiber-of-simple≃CoKleisli─×I</a> <a id="10794" class="Symbol">=</a> <a id="10796" class="Keyword">record</a>
 <a id="10804" class="Symbol">{</a> <a id="10806" href="Categories.Category.Equivalence.html#1131" class="Field">F</a> <a id="10808" class="Symbol">=</a> <a id="10810" href="simple.html#10855" class="Function">F</a>
 <a id="10813" class="Symbol">;</a> <a id="10815" href="Categories.Category.Equivalence.html#1162" class="Field">G</a> <a id="10817" class="Symbol">=</a> <a id="10819" href="simple.html#11062" class="Function">G</a>
 <a id="10822" class="Symbol">;</a> <a id="10824" href="Categories.Category.Equivalence.html#1193" class="Field">weak-inverse</a> <a id="10837" class="Symbol">=</a> <a id="10839" href="simple.html#11269" class="Function">winv</a>
 <a id="10845" class="Symbol">}</a>
 <a id="10848" class="Keyword">where</a>
 <a id="10855" href="simple.html#10855" class="Function">F</a> <a id="10857" class="Symbol">:</a> <a id="10859" class="Symbol">{</a><a id="10860" href="simple.html#10860" class="Bound">I</a> <a id="10862" class="Symbol">:</a> <a id="10864" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="10867" class="Symbol">}</a> <a id="10869" class="Symbol">→</a> <a id="10871" href="Categories.Functor.Core.html#248" class="Record">Functor</a> <a id="10879" class="Symbol">(</a><a id="10880" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="10896" class="Symbol">{</a><a id="10897" href="simple.html#10860" class="Bound">I</a><a id="10898" class="Symbol">})</a> <a id="10901" class="Symbol">(</a><a id="10902" href="Categories.Category.Construction.CoKleisli.html#439" class="Function">CoKleisli</a> <a id="10912" class="Symbol">(</a><a id="10913" href="simple.html#9705" class="Function Operator">─×</a> <a id="10916" href="simple.html#10860" class="Bound">I</a><a id="10917" class="Symbol">))</a>
 <a id="10921" href="simple.html#10855" class="Function">F</a> <a id="10923" class="Symbol">=</a> <a id="10925" class="Keyword">record</a>
      <a id="10938" class="Symbol">{</a> <a id="10940" href="Categories.Functor.Core.html#432" class="Field">F₀</a> <a id="10943" class="Symbol">=</a> <a id="10945" class="Symbol">λ</a> <a id="10947" href="simple.html#10947" class="Bound">A</a> <a id="10949" class="Symbol">→</a> <a id="10951" href="simple.html#10947" class="Bound">A</a>
      <a id="10959" class="Symbol">;</a> <a id="10961" href="Categories.Functor.Core.html#455" class="Field">F₁</a> <a id="10964" class="Symbol">=</a> <a id="10966" class="Symbol">λ</a> <a id="10968" href="simple.html#10968" class="Bound">f</a> <a id="10970" class="Symbol">→</a> <a id="10972" href="simple.html#10968" class="Bound">f</a>
      <a id="10980" class="Symbol">;</a> <a id="10982" href="Categories.Functor.Core.html#511" class="Field">identity</a> <a id="10991" class="Symbol">=</a> <a id="10993" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
      <a id="11004" class="Symbol">;</a> <a id="11006" href="Categories.Functor.Core.html#565" class="Field">homomorphism</a> <a id="11019" class="Symbol">=</a> <a id="11021" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
      <a id="11032" class="Symbol">;</a> <a id="11034" href="Categories.Functor.Core.html#696" class="Field">F-resp-≈</a> <a id="11043" class="Symbol">=</a> <a id="11045" class="Symbol">λ</a> <a id="11047" href="simple.html#11047" class="Bound">x</a> <a id="11049" class="Symbol">→</a> <a id="11051" href="simple.html#11047" class="Bound">x</a>
      <a id="11059" class="Symbol">}</a>
 <a id="11062" href="simple.html#11062" class="Function">G</a> <a id="11064" class="Symbol">:</a> <a id="11066" class="Symbol">{</a><a id="11067" href="simple.html#11067" class="Bound">I</a> <a id="11069" class="Symbol">:</a> <a id="11071" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="11074" class="Symbol">}</a> <a id="11076" class="Symbol">→</a> <a id="11078" href="Categories.Functor.Core.html#248" class="Record">Functor</a> <a id="11086" class="Symbol">(</a><a id="11087" href="Categories.Category.Construction.CoKleisli.html#439" class="Function">CoKleisli</a> <a id="11097" class="Symbol">(</a><a id="11098" href="simple.html#9705" class="Function Operator">─×</a> <a id="11101" href="simple.html#11067" class="Bound">I</a><a id="11102" class="Symbol">))</a> <a id="11105" class="Symbol">(</a><a id="11106" href="simple.html#4871" class="Function">fiber-of-simple</a> <a id="11122" class="Symbol">{</a><a id="11123" href="simple.html#11067" class="Bound">I</a><a id="11124" class="Symbol">})</a>
 <a id="11128" href="simple.html#11062" class="Function">G</a> <a id="11130" class="Symbol">=</a> <a id="11132" class="Keyword">record</a>
      <a id="11145" class="Symbol">{</a> <a id="11147" href="Categories.Functor.Core.html#432" class="Field">F₀</a> <a id="11150" class="Symbol">=</a> <a id="11152" class="Symbol">λ</a> <a id="11154" href="simple.html#11154" class="Bound">z</a> <a id="11156" class="Symbol">→</a> <a id="11158" href="simple.html#11154" class="Bound">z</a>
      <a id="11166" class="Symbol">;</a> <a id="11168" href="Categories.Functor.Core.html#455" class="Field">F₁</a> <a id="11171" class="Symbol">=</a> <a id="11173" class="Symbol">λ</a> <a id="11175" href="simple.html#11175" class="Bound">f</a> <a id="11177" class="Symbol">→</a> <a id="11179" href="simple.html#11175" class="Bound">f</a>
      <a id="11187" class="Symbol">;</a> <a id="11189" href="Categories.Functor.Core.html#511" class="Field">identity</a> <a id="11198" class="Symbol">=</a> <a id="11200" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
      <a id="11211" class="Symbol">;</a> <a id="11213" href="Categories.Functor.Core.html#565" class="Field">homomorphism</a> <a id="11226" class="Symbol">=</a> <a id="11228" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
      <a id="11239" class="Symbol">;</a> <a id="11241" href="Categories.Functor.Core.html#696" class="Field">F-resp-≈</a> <a id="11250" class="Symbol">=</a> <a id="11252" class="Symbol">λ</a> <a id="11254" href="simple.html#11254" class="Bound">x</a> <a id="11256" class="Symbol">→</a> <a id="11258" href="simple.html#11254" class="Bound">x</a>
      <a id="11266" class="Symbol">}</a>
 <a id="11269" href="simple.html#11269" class="Function">winv</a> <a id="11274" class="Symbol">:</a> <a id="11276" class="Symbol">{</a><a id="11277" href="simple.html#11277" class="Bound">I</a> <a id="11279" class="Symbol">:</a> <a id="11281" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="11284" class="Symbol">}</a> <a id="11286" class="Symbol">→</a> <a id="11288" href="Categories.Category.Equivalence.html#713" class="Record">E.WeakInverse</a> <a id="11302" class="Symbol">(</a><a id="11303" href="simple.html#10855" class="Function">F</a> <a id="11305" class="Symbol">{</a><a id="11306" href="simple.html#11277" class="Bound">I</a><a id="11307" class="Symbol">})</a> <a id="11310" href="simple.html#11062" class="Function">G</a>
 <a id="11313" href="simple.html#11269" class="Function">winv</a> <a id="11318" class="Symbol">=</a> <a id="11320" class="Keyword">record</a>
  <a id="11329" class="Symbol">{</a> <a id="11331" href="Categories.Category.Equivalence.html#817" class="Field">F∘G≈id</a> <a id="11338" class="Symbol">=</a> <a id="11340" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2204" class="Function">niHelper</a> <a id="11349" class="Symbol">(</a><a id="11350" class="Keyword">record</a>
    <a id="11361" class="Symbol">{</a> <a id="11363" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2000" class="Field">η</a> <a id="11365" class="Symbol">=</a> <a id="11367" class="Symbol">λ</a> <a id="11369" href="simple.html#11369" class="Bound">X</a> <a id="11371" class="Symbol">→</a> <a id="11373" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
    <a id="11383" class="Symbol">;</a> <a id="11385" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2042" class="Field">η⁻¹</a> <a id="11389" class="Symbol">=</a> <a id="11391" class="Symbol">λ</a> <a id="11393" href="simple.html#11393" class="Bound">X</a> <a id="11395" class="Symbol">→</a> <a id="11397" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
    <a id="11407" class="Symbol">;</a> <a id="11409" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2084" class="Field">commute</a> <a id="11417" class="Symbol">=</a> <a id="11419" class="Symbol">λ</a> <a id="11421" href="simple.html#11421" class="Bound">f</a> <a id="11423" class="Symbol">→</a> <a id="11425" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="11434" class="Symbol">;</a> <a id="11436" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2154" class="Field">iso</a> <a id="11440" class="Symbol">=</a> <a id="11442" class="Symbol">λ</a> <a id="11444" href="simple.html#11444" class="Bound">X</a> <a id="11446" class="Symbol">→</a> <a id="11448" class="Keyword">record</a> <a id="11455" class="Symbol">{</a> <a id="11457" href="Categories.Morphism.html#1100" class="Field">isoˡ</a> <a id="11462" class="Symbol">=</a> <a id="11464" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="11469" class="Symbol">;</a> <a id="11471" href="Categories.Morphism.html#1126" class="Field">isoʳ</a> <a id="11476" class="Symbol">=</a> <a id="11478" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="11483" class="Symbol">}</a> <a id="11485" class="Symbol">})</a>
  <a id="11490" class="Symbol">;</a> <a id="11492" href="Categories.Category.Equivalence.html#862" class="Field">G∘F≈id</a> <a id="11499" class="Symbol">=</a> <a id="11501" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2204" class="Function">niHelper</a> <a id="11510" class="Symbol">(</a><a id="11511" class="Keyword">record</a>
    <a id="11522" class="Symbol">{</a> <a id="11524" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2000" class="Field">η</a> <a id="11526" class="Symbol">=</a> <a id="11528" class="Symbol">λ</a> <a id="11530" href="simple.html#11530" class="Bound">X</a> <a id="11532" href="simple.html#11532" class="Bound">x</a> <a id="11534" class="Symbol">→</a> <a id="11536" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="11542" href="simple.html#11532" class="Bound">x</a>
    <a id="11548" class="Symbol">;</a> <a id="11550" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2042" class="Field">η⁻¹</a> <a id="11554" class="Symbol">=</a> <a id="11556" class="Symbol">λ</a> <a id="11558" href="simple.html#11558" class="Bound">X</a> <a id="11560" href="simple.html#11560" class="Bound">x</a> <a id="11562" class="Symbol">→</a> <a id="11564" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="11570" href="simple.html#11560" class="Bound">x</a>
    <a id="11576" class="Symbol">;</a> <a id="11578" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2084" class="Field">commute</a> <a id="11586" class="Symbol">=</a> <a id="11588" class="Symbol">λ</a> <a id="11590" href="simple.html#11590" class="Bound">f</a> <a id="11592" class="Symbol">→</a> <a id="11594" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="11603" class="Symbol">;</a> <a id="11605" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2154" class="Field">iso</a> <a id="11609" class="Symbol">=</a> <a id="11611" class="Symbol">λ</a> <a id="11613" href="simple.html#11613" class="Bound">X</a> <a id="11615" class="Symbol">→</a> <a id="11617" class="Keyword">record</a> <a id="11624" class="Symbol">{</a> <a id="11626" href="Categories.Morphism.html#1100" class="Field">isoˡ</a> <a id="11631" class="Symbol">=</a> <a id="11633" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="11638" class="Symbol">;</a> <a id="11640" href="Categories.Morphism.html#1126" class="Field">isoʳ</a> <a id="11645" class="Symbol">=</a> <a id="11647" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="11652" class="Symbol">}</a> <a id="11654" class="Symbol">})</a>
  <a id="11659" class="Symbol">}</a>

</pre>
<p>The meat of the proof is in proving that the ordinary slice <code>𝔹/I</code> is the coEilenberg-Moore category of the <code>-×I</code> comonad:</p>
<pre class="Agda"><a id="11794" class="Keyword">open</a> <a id="11799" class="Keyword">import</a> <a id="11806" href="Categories.Category.Construction.CoEilenbergMoore.html" class="Module">Categories.Category.Construction.CoEilenbergMoore</a>
<a id="11856" class="Keyword">open</a> <a id="11861" class="Keyword">import</a> <a id="11868" href="Categories.Category.Slice.html" class="Module">Categories.Category.Slice</a> <a id="11894" href="simple.html#1883" class="Function">SetC</a>

<a id="Slice≃CoEilenbergMoore─×I"></a><a id="11900" href="simple.html#11900" class="Function">Slice≃CoEilenbergMoore─×I</a> <a id="11926" class="Symbol">:</a> <a id="11928" class="Symbol">{</a><a id="11929" href="simple.html#11929" class="Bound">I</a> <a id="11931" class="Symbol">:</a> <a id="11933" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="11936" class="Symbol">}</a> <a id="11938" class="Symbol">→</a>
  <a id="11942" href="Categories.Category.Equivalence.html#1000" class="Record">E.StrongEquivalence</a> <a id="11962" class="Symbol">(</a><a id="11963" href="Categories.Category.Slice.html#811" class="Function">Slice</a> <a id="11969" href="simple.html#11929" class="Bound">I</a><a id="11970" class="Symbol">)</a> <a id="11972" class="Symbol">(</a><a id="11973" href="Categories.Category.Construction.CoEilenbergMoore.html#847" class="Function">CoEilenbergMoore</a> <a id="11990" class="Symbol">(</a><a id="11991" href="simple.html#9705" class="Function Operator">─×</a> <a id="11994" href="simple.html#11929" class="Bound">I</a><a id="11995" class="Symbol">))</a>
<a id="11998" href="simple.html#11900" class="Function">Slice≃CoEilenbergMoore─×I</a> <a id="12024" class="Symbol">{</a><a id="12025" href="simple.html#12025" class="Bound">I</a><a id="12026" class="Symbol">}</a> <a id="12028" class="Symbol">=</a> <a id="12030" class="Keyword">record</a>
  <a id="12039" class="Symbol">{</a> <a id="12041" href="Categories.Category.Equivalence.html#1131" class="Field">F</a> <a id="12043" class="Symbol">=</a> <a id="12045" href="simple.html#12095" class="Function">F</a>
  <a id="12049" class="Symbol">;</a> <a id="12051" href="Categories.Category.Equivalence.html#1162" class="Field">G</a> <a id="12053" class="Symbol">=</a> <a id="12055" href="simple.html#12517" class="Function">G</a>
  <a id="12059" class="Symbol">;</a> <a id="12061" href="Categories.Category.Equivalence.html#1193" class="Field">weak-inverse</a> <a id="12074" class="Symbol">=</a> <a id="12076" href="simple.html#12955" class="Function">winv</a>
  <a id="12083" class="Symbol">}</a>
  <a id="12087" class="Keyword">where</a>
  <a id="12095" href="simple.html#12095" class="Function">F</a> <a id="12097" class="Symbol">:</a> <a id="12099" href="Categories.Functor.Core.html#248" class="Record">Functor</a> <a id="12107" class="Symbol">(</a><a id="12108" href="Categories.Category.Slice.html#811" class="Function">Slice</a> <a id="12114" href="simple.html#12025" class="Bound">I</a><a id="12115" class="Symbol">)</a> <a id="12117" class="Symbol">(</a><a id="12118" href="Categories.Category.Construction.CoEilenbergMoore.html#847" class="Function">CoEilenbergMoore</a> <a id="12135" class="Symbol">(</a><a id="12136" href="simple.html#9705" class="Function Operator">─×</a> <a id="12139" href="simple.html#12025" class="Bound">I</a><a id="12140" class="Symbol">))</a>
  <a id="12145" href="simple.html#12095" class="Function">F</a> <a id="12147" class="Symbol">=</a> <a id="12149" class="Keyword">record</a>
   <a id="12159" class="Symbol">{</a> <a id="12161" href="Categories.Functor.Core.html#432" class="Field">F₀</a> <a id="12164" class="Symbol">=</a> <a id="12166" class="Symbol">λ</a> <a id="12168" class="Symbol">{</a> <a id="12170" class="Symbol">(</a><a id="12171" href="Categories.Category.Slice.html#503" class="InductiveConstructor">sliceobj</a> <a id="12180" class="Symbol">{</a><a id="12181" href="simple.html#12181" class="Bound">Y</a><a id="12182" class="Symbol">}</a> <a id="12184" href="simple.html#12184" class="Bound">arr</a><a id="12187" class="Symbol">)</a> <a id="12189" class="Symbol">→</a>
     <a id="12196" class="Keyword">record</a> <a id="12203" class="Symbol">{</a> <a id="12205" href="Categories.Category.Construction.CoEilenbergMoore.html#503" class="Field">A</a> <a id="12207" class="Symbol">=</a> <a id="12209" href="simple.html#12181" class="Bound">Y</a>
            <a id="12223" class="Symbol">;</a> <a id="12225" href="Categories.Category.Construction.CoEilenbergMoore.html#522" class="Field">coaction</a> <a id="12234" class="Symbol">=</a> <a id="12236" class="Symbol">λ</a> <a id="12238" href="simple.html#12238" class="Bound">z</a> <a id="12240" class="Symbol">→</a> <a id="12242" href="simple.html#12238" class="Bound">z</a> <a id="12244" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12246" href="simple.html#12184" class="Bound">arr</a> <a id="12250" href="simple.html#12238" class="Bound">z</a>
            <a id="12264" class="Symbol">;</a> <a id="12266" href="Categories.Category.Construction.CoEilenbergMoore.html#548" class="Field">commute</a> <a id="12274" class="Symbol">=</a> <a id="12276" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
            <a id="12293" class="Symbol">;</a> <a id="12295" href="Categories.Category.Construction.CoEilenbergMoore.html#607" class="Field">identity</a> <a id="12304" class="Symbol">=</a> <a id="12306" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="12311" class="Symbol">}</a> <a id="12313" class="Symbol">}</a>
   <a id="12318" class="Symbol">;</a> <a id="12320" href="Categories.Functor.Core.html#455" class="Field">F₁</a> <a id="12323" class="Symbol">=</a> <a id="12325" class="Symbol">λ</a> <a id="12327" class="Symbol">{</a> <a id="12329" class="Symbol">(</a><a id="12330" href="Categories.Category.Slice.html#683" class="InductiveConstructor">slicearr</a> <a id="12339" class="Symbol">{</a><a id="12340" href="simple.html#12340" class="Bound">h</a><a id="12341" class="Symbol">}</a> <a id="12343" href="simple.html#12343" class="Bound">Δ</a><a id="12344" class="Symbol">)</a> <a id="12346" class="Symbol">→</a> <a id="12348" class="Keyword">record</a>
     <a id="12360" class="Symbol">{</a> <a id="12362" href="Categories.Category.Construction.CoEilenbergMoore.html#773" class="Field">arr</a> <a id="12366" class="Symbol">=</a> <a id="12368" class="Symbol">λ</a> <a id="12370" href="simple.html#12370" class="Bound">x</a> <a id="12372" class="Symbol">→</a> <a id="12374" href="simple.html#12340" class="Bound">h</a> <a id="12376" href="simple.html#12370" class="Bound">x</a>
     <a id="12383" class="Symbol">;</a> <a id="12385" href="Categories.Category.Construction.CoEilenbergMoore.html#797" class="Field">commute</a> <a id="12393" class="Symbol">=</a> <a id="12395" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="12400" class="Symbol">(λ</a> <a id="12403" href="simple.html#12403" class="Bound">x</a> <a id="12405" href="simple.html#12405" class="Bound">x₁</a> <a id="12408" class="Symbol">→</a> <a id="12410" href="simple.html#12340" class="Bound">h</a> <a id="12412" href="simple.html#12405" class="Bound">x₁</a> <a id="12415" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12417" href="simple.html#12403" class="Bound">x</a> <a id="12419" href="simple.html#12405" class="Bound">x₁</a><a id="12421" class="Symbol">)</a> <a id="12423" href="simple.html#12343" class="Bound">Δ</a>  <a id="12426" class="Symbol">}</a> <a id="12428" class="Symbol">}</a>
   <a id="12433" class="Symbol">;</a> <a id="12435" href="Categories.Functor.Core.html#511" class="Field">identity</a> <a id="12444" class="Symbol">=</a> <a id="12446" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
   <a id="12454" class="Symbol">;</a> <a id="12456" href="Categories.Functor.Core.html#565" class="Field">homomorphism</a> <a id="12469" class="Symbol">=</a> <a id="12471" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
   <a id="12479" class="Symbol">;</a> <a id="12481" href="Categories.Functor.Core.html#696" class="Field">F-resp-≈</a> <a id="12490" class="Symbol">=</a> <a id="12492" class="Symbol">λ</a> <a id="12494" class="Symbol">{</a> <a id="12496" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="12501" class="Symbol">→</a> <a id="12503" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="12508" class="Symbol">}</a>
   <a id="12513" class="Symbol">}</a>
  <a id="12517" href="simple.html#12517" class="Function">G</a> <a id="12519" class="Symbol">:</a> <a id="12521" href="Categories.Functor.Core.html#248" class="Record">Functor</a> <a id="12529" class="Symbol">(</a><a id="12530" href="Categories.Category.Construction.CoEilenbergMoore.html#847" class="Function">CoEilenbergMoore</a> <a id="12547" class="Symbol">(</a><a id="12548" href="simple.html#9705" class="Function Operator">─×</a> <a id="12551" href="simple.html#12025" class="Bound">I</a><a id="12552" class="Symbol">))</a> <a id="12555" class="Symbol">(</a><a id="12556" href="Categories.Category.Slice.html#811" class="Function">Slice</a> <a id="12562" href="simple.html#12025" class="Bound">I</a><a id="12563" class="Symbol">)</a>
  <a id="12567" href="simple.html#12517" class="Function">G</a> <a id="12569" class="Symbol">=</a> <a id="12571" class="Keyword">record</a>
   <a id="12581" class="Symbol">{</a> <a id="12583" href="Categories.Functor.Core.html#432" class="Field">F₀</a> <a id="12586" class="Symbol">=</a> <a id="12588" class="Symbol">λ</a> <a id="12590" class="Symbol">{</a> <a id="12592" class="Keyword">record</a>
     <a id="12604" class="Symbol">{</a> <a id="12606" href="Categories.Category.Construction.CoEilenbergMoore.html#503" class="Field">A</a> <a id="12608" class="Symbol">=</a> <a id="12610" href="simple.html#12610" class="Bound">A</a>
     <a id="12617" class="Symbol">;</a> <a id="12619" href="Categories.Category.Construction.CoEilenbergMoore.html#522" class="Field">coaction</a> <a id="12628" class="Symbol">=</a> <a id="12630" href="simple.html#12630" class="Bound">coaction</a>
     <a id="12644" class="Symbol">;</a> <a id="12646" href="Categories.Category.Construction.CoEilenbergMoore.html#548" class="Field">commute</a> <a id="12654" class="Symbol">=</a> <a id="12656" href="simple.html#12656" class="Bound">commute</a>
     <a id="12669" class="Symbol">;</a> <a id="12671" href="Categories.Category.Construction.CoEilenbergMoore.html#607" class="Field">identity</a> <a id="12680" class="Symbol">=</a> <a id="12682" href="simple.html#12682" class="Bound">identity</a>
     <a id="12696" class="Symbol">}</a> <a id="12698" class="Symbol">→</a> <a id="12700" href="Categories.Category.Slice.html#503" class="InductiveConstructor">sliceobj</a> <a id="12709" class="Symbol">λ</a> <a id="12711" href="simple.html#12711" class="Bound">x</a> <a id="12713" class="Symbol">→</a> <a id="12715" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="12721" class="Symbol">(</a><a id="12722" href="simple.html#12630" class="Bound">coaction</a> <a id="12731" href="simple.html#12711" class="Bound">x</a><a id="12732" class="Symbol">)</a> <a id="12734" class="Symbol">}</a>
   <a id="12739" class="Symbol">;</a> <a id="12741" href="Categories.Functor.Core.html#455" class="Field">F₁</a> <a id="12744" class="Symbol">=</a> <a id="12746" class="Symbol">λ</a> <a id="12748" class="Symbol">{</a> <a id="12750" class="Keyword">record</a>
     <a id="12762" class="Symbol">{</a> <a id="12764" href="Categories.Category.Construction.CoEilenbergMoore.html#773" class="Field">arr</a> <a id="12768" class="Symbol">=</a> <a id="12770" href="simple.html#12770" class="Bound">arr</a>
     <a id="12779" class="Symbol">;</a> <a id="12781" href="Categories.Category.Construction.CoEilenbergMoore.html#797" class="Field">commute</a> <a id="12789" class="Symbol">=</a> <a id="12791" href="simple.html#12791" class="Bound">commute</a>
     <a id="12804" class="Symbol">}</a> <a id="12806" class="Symbol">→</a> <a id="12808" href="Categories.Category.Slice.html#683" class="InductiveConstructor">slicearr</a> <a id="12817" class="Symbol">{</a><a id="12818" class="Argument">h</a> <a id="12820" class="Symbol">=</a> <a id="12822" href="simple.html#12770" class="Bound">arr</a><a id="12825" class="Symbol">}</a> <a id="12827" class="Symbol">(</a><a id="12828" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="12833" class="Symbol">(λ</a> <a id="12836" href="simple.html#12836" class="Bound">x</a> <a id="12838" href="simple.html#12838" class="Bound">x₁</a> <a id="12841" class="Symbol">→</a> <a id="12843" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="12849" class="Symbol">(</a><a id="12850" href="simple.html#12836" class="Bound">x</a> <a id="12852" href="simple.html#12838" class="Bound">x₁</a><a id="12854" class="Symbol">))</a> <a id="12857" href="simple.html#12791" class="Bound">commute</a><a id="12864" class="Symbol">)</a> <a id="12866" class="Symbol">}</a>
   <a id="12871" class="Symbol">;</a> <a id="12873" href="Categories.Functor.Core.html#511" class="Field">identity</a> <a id="12882" class="Symbol">=</a> <a id="12884" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
   <a id="12892" class="Symbol">;</a> <a id="12894" href="Categories.Functor.Core.html#565" class="Field">homomorphism</a> <a id="12907" class="Symbol">=</a> <a id="12909" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
   <a id="12917" class="Symbol">;</a> <a id="12919" href="Categories.Functor.Core.html#696" class="Field">F-resp-≈</a> <a id="12928" class="Symbol">=</a> <a id="12930" class="Symbol">λ</a> <a id="12932" class="Symbol">{</a> <a id="12934" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="12939" class="Symbol">→</a> <a id="12941" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="12946" class="Symbol">}</a>
   <a id="12951" class="Symbol">}</a>
  <a id="12955" href="simple.html#12955" class="Function">winv</a> <a id="12960" class="Symbol">:</a> <a id="12962" href="Categories.Category.Equivalence.html#713" class="Record">E.WeakInverse</a> <a id="12976" href="simple.html#12095" class="Function">F</a> <a id="12978" href="simple.html#12517" class="Function">G</a>
  <a id="12982" href="simple.html#12955" class="Function">winv</a> <a id="12987" class="Symbol">=</a> <a id="12989" class="Keyword">record</a>
   <a id="12999" class="Symbol">{</a> <a id="13001" href="Categories.Category.Equivalence.html#817" class="Field">F∘G≈id</a> <a id="13008" class="Symbol">=</a> <a id="13010" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2204" class="Function">niHelper</a> <a id="13019" class="Symbol">(</a><a id="13020" class="Keyword">record</a>
     <a id="13032" class="Symbol">{</a> <a id="13034" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2000" class="Field">η</a> <a id="13036" class="Symbol">=</a> <a id="13038" class="Symbol">λ</a> <a id="13040" class="Symbol">{</a> <a id="13042" class="Keyword">record</a>
       <a id="13056" class="Symbol">{</a> <a id="13058" href="Categories.Category.Construction.CoEilenbergMoore.html#503" class="Field">A</a> <a id="13060" class="Symbol">=</a> <a id="13062" href="simple.html#13062" class="Bound">A</a>
       <a id="13071" class="Symbol">;</a> <a id="13073" href="Categories.Category.Construction.CoEilenbergMoore.html#522" class="Field">coaction</a> <a id="13082" class="Symbol">=</a> <a id="13084" href="simple.html#13084" class="Bound">coaction</a>
       <a id="13100" class="Symbol">;</a> <a id="13102" href="Categories.Category.Construction.CoEilenbergMoore.html#548" class="Field">commute</a> <a id="13110" class="Symbol">=</a> <a id="13112" href="simple.html#13112" class="Bound">commute</a>
       <a id="13127" class="Symbol">;</a> <a id="13129" href="Categories.Category.Construction.CoEilenbergMoore.html#607" class="Field">identity</a> <a id="13138" class="Symbol">=</a> <a id="13140" href="simple.html#13140" class="Bound">identity</a>
       <a id="13156" class="Symbol">}</a> <a id="13158" class="Symbol">→</a> <a id="13160" class="Keyword">record</a> <a id="13167" class="Symbol">{</a> <a id="13169" href="Categories.Category.Construction.CoEilenbergMoore.html#773" class="Field">arr</a> <a id="13173" class="Symbol">=</a> <a id="13175" class="Symbol">λ</a> <a id="13177" href="simple.html#13177" class="Bound">a</a> <a id="13179" class="Symbol">→</a> <a id="13181" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="13187" class="Symbol">(</a><a id="13188" href="simple.html#13084" class="Bound">coaction</a> <a id="13197" href="simple.html#13177" class="Bound">a</a><a id="13198" class="Symbol">)</a>
                  <a id="13218" class="Symbol">;</a> <a id="13220" href="Categories.Category.Construction.CoEilenbergMoore.html#797" class="Field">commute</a> <a id="13228" class="Symbol">=</a> <a id="13230" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="13235" class="Symbol">(λ</a> <a id="13238" href="simple.html#13238" class="Bound">x</a> <a id="13240" href="simple.html#13240" class="Bound">x₁</a> <a id="13243" class="Symbol">→</a> <a id="13245" href="simple.html#13084" class="Bound">coaction</a> <a id="13254" class="Symbol">(</a><a id="13255" href="simple.html#13238" class="Bound">x</a> <a id="13257" href="simple.html#13240" class="Bound">x₁</a><a id="13259" class="Symbol">))</a> <a id="13262" href="simple.html#13140" class="Bound">identity</a> <a id="13271" class="Symbol">}</a> <a id="13273" class="Symbol">}</a>
     <a id="13280" class="Symbol">;</a> <a id="13282" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2042" class="Field">η⁻¹</a> <a id="13286" class="Symbol">=</a> <a id="13288" class="Symbol">λ</a> <a id="13290" class="Symbol">{</a> <a id="13292" class="Keyword">record</a>
       <a id="13306" class="Symbol">{</a> <a id="13308" href="Categories.Category.Construction.CoEilenbergMoore.html#503" class="Field">A</a> <a id="13310" class="Symbol">=</a> <a id="13312" href="simple.html#13312" class="Bound">A</a>
       <a id="13321" class="Symbol">;</a> <a id="13323" href="Categories.Category.Construction.CoEilenbergMoore.html#522" class="Field">coaction</a> <a id="13332" class="Symbol">=</a> <a id="13334" href="simple.html#13334" class="Bound">coaction</a>
       <a id="13350" class="Symbol">;</a> <a id="13352" href="Categories.Category.Construction.CoEilenbergMoore.html#548" class="Field">commute</a> <a id="13360" class="Symbol">=</a> <a id="13362" href="simple.html#13362" class="Bound">commute</a>
       <a id="13377" class="Symbol">;</a> <a id="13379" href="Categories.Category.Construction.CoEilenbergMoore.html#607" class="Field">identity</a> <a id="13388" class="Symbol">=</a> <a id="13390" href="simple.html#13390" class="Bound">identity</a>
       <a id="13406" class="Symbol">}</a> <a id="13408" class="Symbol">→</a> <a id="13410" class="Keyword">record</a> <a id="13417" class="Symbol">{</a> <a id="13419" href="Categories.Category.Construction.CoEilenbergMoore.html#773" class="Field">arr</a> <a id="13423" class="Symbol">=</a> <a id="13425" class="Symbol">λ</a> <a id="13427" href="simple.html#13427" class="Bound">z</a> <a id="13429" class="Symbol">→</a> <a id="13431" href="simple.html#13427" class="Bound">z</a>
                  <a id="13451" class="Symbol">;</a> <a id="13453" href="Categories.Category.Construction.CoEilenbergMoore.html#797" class="Field">commute</a> <a id="13461" class="Symbol">=</a>
                    <a id="13483" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="13488" class="Symbol">(λ</a> <a id="13491" href="simple.html#13491" class="Bound">x</a> <a id="13493" href="simple.html#13493" class="Bound">x₁</a> <a id="13496" class="Symbol">→</a> <a id="13498" href="simple.html#13491" class="Bound">x</a> <a id="13500" href="simple.html#13493" class="Bound">x₁</a> <a id="13503" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13505" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="13511" class="Symbol">(</a><a id="13512" href="simple.html#13334" class="Bound">coaction</a> <a id="13521" href="simple.html#13493" class="Bound">x₁</a><a id="13523" class="Symbol">)</a> <a id="13525" class="Symbol">)</a> <a id="13527" class="Symbol">(</a><a id="13528" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="13532" href="simple.html#13390" class="Bound">identity</a><a id="13540" class="Symbol">)</a> <a id="13542" class="Symbol">}</a> <a id="13544" class="Symbol">}</a>
     <a id="13551" class="Symbol">;</a> <a id="13553" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2084" class="Field">commute</a> <a id="13561" class="Symbol">=</a> <a id="13563" class="Symbol">λ</a> <a id="13565" class="Symbol">{</a> <a id="13567" class="Keyword">record</a>
       <a id="13581" class="Symbol">{</a> <a id="13583" href="Categories.Category.Construction.CoEilenbergMoore.html#773" class="Field">arr</a> <a id="13587" class="Symbol">=</a> <a id="13589" href="simple.html#13589" class="Bound">arr</a>
       <a id="13600" class="Symbol">;</a> <a id="13602" href="Categories.Category.Construction.CoEilenbergMoore.html#797" class="Field">commute</a> <a id="13610" class="Symbol">=</a> <a id="13612" href="simple.html#13612" class="Bound">commute</a>
       <a id="13627" class="Symbol">}</a> <a id="13629" class="Symbol">→</a> <a id="13631" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="13636" class="Symbol">(λ</a> <a id="13639" href="simple.html#13639" class="Bound">x</a> <a id="13641" href="simple.html#13641" class="Bound">x₁</a> <a id="13644" class="Symbol">→</a> <a id="13646" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="13652" class="Symbol">(</a><a id="13653" href="simple.html#13639" class="Bound">x</a> <a id="13655" href="simple.html#13641" class="Bound">x₁</a><a id="13657" class="Symbol">))</a> <a id="13660" href="simple.html#13612" class="Bound">commute</a> <a id="13668" class="Symbol">}</a>
     <a id="13675" class="Symbol">;</a> <a id="13677" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2154" class="Field">iso</a> <a id="13681" class="Symbol">=</a> <a id="13683" class="Symbol">λ</a> <a id="13685" class="Symbol">{</a> <a id="13687" class="Keyword">record</a>
       <a id="13701" class="Symbol">{</a> <a id="13703" href="Categories.Category.Construction.CoEilenbergMoore.html#503" class="Field">A</a> <a id="13705" class="Symbol">=</a> <a id="13707" href="simple.html#13707" class="Bound">A</a>
       <a id="13716" class="Symbol">;</a> <a id="13718" href="Categories.Category.Construction.CoEilenbergMoore.html#522" class="Field">coaction</a> <a id="13727" class="Symbol">=</a> <a id="13729" href="simple.html#13729" class="Bound">coaction</a>
       <a id="13745" class="Symbol">;</a> <a id="13747" href="Categories.Category.Construction.CoEilenbergMoore.html#548" class="Field">commute</a> <a id="13755" class="Symbol">=</a> <a id="13757" href="simple.html#13757" class="Bound">commute</a>
       <a id="13772" class="Symbol">;</a> <a id="13774" href="Categories.Category.Construction.CoEilenbergMoore.html#607" class="Field">identity</a> <a id="13783" class="Symbol">=</a> <a id="13785" href="simple.html#13785" class="Bound">identity</a>
       <a id="13801" class="Symbol">}</a> <a id="13803" class="Symbol">→</a> <a id="13805" class="Keyword">record</a> <a id="13812" class="Symbol">{</a> <a id="13814" href="Categories.Morphism.html#1100" class="Field">isoˡ</a> <a id="13819" class="Symbol">=</a> <a id="13821" href="simple.html#13785" class="Bound">identity</a> <a id="13830" class="Symbol">;</a> <a id="13832" href="Categories.Morphism.html#1126" class="Field">isoʳ</a> <a id="13837" class="Symbol">=</a> <a id="13839" href="simple.html#13785" class="Bound">identity</a> <a id="13848" class="Symbol">}</a> <a id="13850" class="Symbol">}</a>
     <a id="13857" class="Symbol">})</a>
   <a id="13863" class="Symbol">;</a> <a id="13865" href="Categories.Category.Equivalence.html#862" class="Field">G∘F≈id</a> <a id="13872" class="Symbol">=</a> <a id="13874" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2204" class="Function">niHelper</a> <a id="13883" class="Symbol">(</a><a id="13884" class="Keyword">record</a>
     <a id="13896" class="Symbol">{</a> <a id="13898" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2000" class="Field">η</a> <a id="13900" class="Symbol">=</a> <a id="13902" class="Symbol">λ</a> <a id="13904" href="simple.html#13904" class="Bound">arr</a> <a id="13908" class="Symbol">→</a> <a id="13910" href="Categories.Category.Slice.html#683" class="InductiveConstructor">slicearr</a> <a id="13919" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
     <a id="13929" class="Symbol">;</a> <a id="13931" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2042" class="Field">η⁻¹</a> <a id="13935" class="Symbol">=</a> <a id="13937" class="Symbol">λ</a> <a id="13939" href="simple.html#13939" class="Bound">obj</a> <a id="13943" class="Symbol">→</a> <a id="13945" href="Categories.Category.Slice.html#683" class="InductiveConstructor">slicearr</a> <a id="13954" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
     <a id="13964" class="Symbol">;</a> <a id="13966" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2084" class="Field">commute</a> <a id="13974" class="Symbol">=</a> <a id="13976" class="Symbol">λ</a> <a id="13978" href="simple.html#13978" class="Bound">arr</a> <a id="13982" class="Symbol">→</a> <a id="13984" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
     <a id="13994" class="Symbol">;</a> <a id="13996" href="Categories.NaturalTransformation.NaturalIsomorphism.html#2154" class="Field">iso</a> <a id="14000" class="Symbol">=</a> <a id="14002" class="Symbol">λ</a> <a id="14004" href="simple.html#14004" class="Bound">X</a> <a id="14006" class="Symbol">→</a> <a id="14008" class="Keyword">record</a> <a id="14015" class="Symbol">{</a> <a id="14017" href="Categories.Morphism.html#1100" class="Field">isoˡ</a> <a id="14022" class="Symbol">=</a> <a id="14024" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="14029" class="Symbol">;</a> <a id="14031" href="Categories.Morphism.html#1126" class="Field">isoʳ</a> <a id="14036" class="Symbol">=</a> <a id="14038" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="14043" class="Symbol">}</a>
     <a id="14050" class="Symbol">})</a>
   <a id="14056" class="Symbol">}</a>
</pre>
